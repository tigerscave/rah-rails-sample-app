<!DOCTYPE html>
<html id="custDomain" class="fontawesome-i2svg-active fontawesome-i2svg-complete gr__railstutorial_org"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
<script type="text/javascript" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/1310fd97f1.js"></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/nr-1123.js"></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/inferredEvents.js" async=""></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/120259081996654.js" async=""></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/identity.js" async=""></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/sdk_002.js" async="" crossorigin="anonymous"></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/6713.js" async="" type="text/javascript"></script><script type="text/javascript" async="" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/54eea5d20a23b37d87000040.js"></script><script id="facebook-jssdk" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/sdk.js"></script><script id="twitter-wjs" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/widgets.js"></script><script async="" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/fbevents.js"></script><script async="" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/analytics.js"></script><script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/1197428788.js" type="text/javascript"></script>

<meta name="csrf-param" content="authenticity_token">
<meta name="csrf-token" content="LSKnL5HyZu/714DOwp1AmKyTjb4H84EUzieoXawgL8+achrBxa4t9Os+hYXiX5TfQ7YhFwVnPfuENLrPFO2WcQ==">
<meta charset="UTF-8">
<script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"1310fd97f1","applicationID":"71497409","transactionName":"IVZWR0tbWF4BFxhWVw1SSxxaQUdGCwhoRl0DXQ==","queueTime":3,"applicationTime":1023,"agent":""}</script>
<script>window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1123.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script>
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Chapter 7: Sign up | Ruby on Rails Tutorial (Rails 5) | Softcover.io</title>
<style type="text/css">svg:not(:root).svg-inline--fa{overflow:visible}.svg-inline--fa{display:inline-block;font-size:inherit;height:1em;overflow:visible;vertical-align:-.125em}.svg-inline--fa.fa-lg{vertical-align:-.225em}.svg-inline--fa.fa-w-1{width:.0625em}.svg-inline--fa.fa-w-2{width:.125em}.svg-inline--fa.fa-w-3{width:.1875em}.svg-inline--fa.fa-w-4{width:.25em}.svg-inline--fa.fa-w-5{width:.3125em}.svg-inline--fa.fa-w-6{width:.375em}.svg-inline--fa.fa-w-7{width:.4375em}.svg-inline--fa.fa-w-8{width:.5em}.svg-inline--fa.fa-w-9{width:.5625em}.svg-inline--fa.fa-w-10{width:.625em}.svg-inline--fa.fa-w-11{width:.6875em}.svg-inline--fa.fa-w-12{width:.75em}.svg-inline--fa.fa-w-13{width:.8125em}.svg-inline--fa.fa-w-14{width:.875em}.svg-inline--fa.fa-w-15{width:.9375em}.svg-inline--fa.fa-w-16{width:1em}.svg-inline--fa.fa-w-17{width:1.0625em}.svg-inline--fa.fa-w-18{width:1.125em}.svg-inline--fa.fa-w-19{width:1.1875em}.svg-inline--fa.fa-w-20{width:1.25em}.svg-inline--fa.fa-pull-left{margin-right:.3em;width:auto}.svg-inline--fa.fa-pull-right{margin-left:.3em;width:auto}.svg-inline--fa.fa-border{height:1.5em}.svg-inline--fa.fa-li{width:2em}.svg-inline--fa.fa-fw{width:1.25em}.fa-layers svg.svg-inline--fa{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.fa-layers{display:inline-block;height:1em;position:relative;text-align:center;vertical-align:-.125em;width:1em}.fa-layers svg.svg-inline--fa{-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter,.fa-layers-text{display:inline-block;position:absolute;text-align:center}.fa-layers-text{left:50%;top:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);-webkit-transform-origin:center center;transform-origin:center center}.fa-layers-counter{background-color:#ff253a;border-radius:1em;-webkit-box-sizing:border-box;box-sizing:border-box;color:#fff;height:1.5em;line-height:1;max-width:5em;min-width:1.5em;overflow:hidden;padding:.25em;right:0;text-overflow:ellipsis;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-bottom-right{bottom:0;right:0;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom right;transform-origin:bottom right}.fa-layers-bottom-left{bottom:0;left:0;right:auto;top:auto;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:bottom left;transform-origin:bottom left}.fa-layers-top-right{right:0;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top right;transform-origin:top right}.fa-layers-top-left{left:0;right:auto;top:0;-webkit-transform:scale(.25);transform:scale(.25);-webkit-transform-origin:top left;transform-origin:top left}.fa-lg{font-size:1.3333333333em;line-height:.75em;vertical-align:-.0667em}.fa-xs{font-size:.75em}.fa-sm{font-size:.875em}.fa-1x{font-size:1em}.fa-2x{font-size:2em}.fa-3x{font-size:3em}.fa-4x{font-size:4em}.fa-5x{font-size:5em}.fa-6x{font-size:6em}.fa-7x{font-size:7em}.fa-8x{font-size:8em}.fa-9x{font-size:9em}.fa-10x{font-size:10em}.fa-fw{text-align:center;width:1.25em}.fa-ul{list-style-type:none;margin-left:2.5em;padding-left:0}.fa-ul>li{position:relative}.fa-li{left:-2em;position:absolute;text-align:center;width:2em;line-height:inherit}.fa-border{border:solid .08em #eee;border-radius:.1em;padding:.2em .25em .15em}.fa-pull-left{float:left}.fa-pull-right{float:right}.fa.fa-pull-left,.fab.fa-pull-left,.fal.fa-pull-left,.far.fa-pull-left,.fas.fa-pull-left{margin-right:.3em}.fa.fa-pull-right,.fab.fa-pull-right,.fal.fa-pull-right,.far.fa-pull-right,.fas.fa-pull-right{margin-left:.3em}.fa-spin{-webkit-animation:fa-spin 2s infinite linear;animation:fa-spin 2s infinite linear}.fa-pulse{-webkit-animation:fa-spin 1s infinite steps(8);animation:fa-spin 1s infinite steps(8)}@-webkit-keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes fa-spin{0%{-webkit-transform:rotate(0);transform:rotate(0)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.fa-rotate-90{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.fa-rotate-180{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.fa-rotate-270{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.fa-flip-horizontal{-webkit-transform:scale(-1,1);transform:scale(-1,1)}.fa-flip-vertical{-webkit-transform:scale(1,-1);transform:scale(1,-1)}.fa-flip-both,.fa-flip-horizontal.fa-flip-vertical{-webkit-transform:scale(-1,-1);transform:scale(-1,-1)}:root .fa-flip-both,:root .fa-flip-horizontal,:root .fa-flip-vertical,:root .fa-rotate-180,:root .fa-rotate-270,:root .fa-rotate-90{-webkit-filter:none;filter:none}.fa-stack{display:inline-block;height:2em;position:relative;width:2.5em}.fa-stack-1x,.fa-stack-2x{bottom:0;left:0;margin:auto;position:absolute;right:0;top:0}.svg-inline--fa.fa-stack-1x{height:1em;width:1.25em}.svg-inline--fa.fa-stack-2x{height:2em;width:2.5em}.fa-inverse{color:#fff}.sr-only{border:0;clip:rect(0,0,0,0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.sr-only-focusable:active,.sr-only-focusable:focus{clip:auto;height:auto;margin:0;overflow:visible;position:static;width:auto}</style><link href="https://www.railstutorial.org/apple-touch-icon-precomposed.png" rel="apple-touch-icon-precomposed">
<link href="https://www.railstutorial.org/favicon.png" rel="icon">
<link href="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/css.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" media="screen" href="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/reading-eaca49d15474ae97f8b9a791e0f4f8d8013ef9a746e79290b42d.css">
<link href="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/print-f4bd271fd41b8086410e78c14546336605a29e5c72c2d08b094c7c.css" media="print" rel="stylesheet" type="text/css">
<script>
  window.Config = {
    env: "production",
    bucket: "softcover",
    previewBucket: "softcover-cloud",
    userId: false
  }
</script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/jquery-2.js" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/jquery.js" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/underscore-min.js" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/hammer.js" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/a" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/jsapi.js" type="text/javascript"></script>
<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/application-b18570303a815ebf61dd86e05227f96aa6b08443749aafde2.js"></script>

<meta content="http://www.railstutorial.org" property="og:url">
<meta content="Ruby on Rails Tutorial (Rails 5)" property="og:title">
<meta content="Newly updated for Rails 5, the Ruby on Rails Tutorial book and screencast series teach you how to develop and deploy real, industrial-strength web applications with Ruby on Rails, the open-source web framework that powers top websites such as Twitter, Hulu, GitHub, and the Yellow Pages. The Ruby on Rails Tutorial book is available for free online and is available for purchase as an ebook (PDF, EPUB, and MOBI formats). The companion screencast series includes 14 individual lessons, one for each chapter of the Ruby on Rails Tutorial book." property="og:description">
<meta content="Softcover.io" property="og:site_name">
<meta content="https://softcover.s3.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/images/cover-web.png" property="og:image">
<meta content="https://softcover.s3.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/images/cover-web.png" property="og:image:secure_url">
<meta content="image/png" property="og:image:type">
<meta content="500" property="og:image:width">
<meta content="500" property="og:image:height">
<meta content="216" property="book_id">
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('require', 'linker');
  ga('linker:autoLink', ['www.railstutorial.org', 'softcover.io']);

  ga('create', 'UA-46858978-1', 'softcover.io', {'allowLinker': true});
  ga('send', 'pageview');

  ga('create', 'UA-8667566-1', 'auto', {
    'name': 'book',
    'allowLinker': true
  });

  ga('book.send', 'pageview');

</script>

<!-- Facebook Pixel Code -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '120259081996654', {
    em: '',
  });
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=120259081996654&ev=PageView&noscript=1"
/></noscript>
<!-- End Facebook Pixel Code -->


<script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>


<script src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/custom_domain_js.js" type="text/javascript"></script>
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#1d3c78;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script id="mathJaxJS" type="text/javascript" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/MathJax.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>
<body class="reading side-menu-opened" data-gr-c-s-loaded="true"><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div><div id="MathJax_Message" style="display: none;"></div>
<noscript>
<div id='noscript'>
<h2>Please enable javascript</h2>
This site requires you to allow JavaScript to run in the browser for all features to work. Thank you!
</div>
</noscript>
<script type="text/javascript">
!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
window.fbAsyncInit = function() {
FB.init({
appId      : '145973438749643',
xfbml      : true,
version    : 'v2.0'
});
};
(function(d, s, id){
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) {return;}
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/sdk.js";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));
</script>
<div class="container">
<div id="header">
<div class="wrapper">
<a class="logo" href="https://www.softcover.io/"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/logo-cb2b799a5b84e014246f782d1e9330447da7f588ec6ca125890c7cd.png" alt="Logo">
</a><a id="mobileMenu" href="javascript://"><div class="closedMenu">

<span>Menu</span>
</div>
<div class="openMenu">
x
<span>Close</span>
</div>
</a><div class="j_userHeader closeLeft" style="display:inline"><ul class="headerMenu">
<li><a href="https://www.softcover.io/login">Log In</a></li>
<li><a href="https://www.softcover.io/account/sign_up">Sign Up</a></li>
</ul>
</div>
<div id="dropBG"></div>
<div class="clear"></div>
</div>
</div>

<div class="sc-content">
<!-- - provide :signupCopy do -->
<!-- %strong GET A FREE EMAIL COURSE ON WEB DEVELOPMENT -->
<!-- %p Sign up now to get a free 8-part email course on learning web development. This will also ensure you get updates about the Ruby on Rails Tutorial and related products (such as the <a href="http://learnenough.com/">Learn Enough to Be Dangerous</a> series of tutorials). -->
<link rel="stylesheet" media="screen" href="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/custom.css">
<div class="page-book">
<div class="bookHeader">
<div class="wrapper">
<div class="bookCover">
<a href="https://www.railstutorial.org/book"><img class="cover" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/cover-web.png" alt="Cover web">
<img class="coverBG" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/cover_bg-a267f19fd8b824c7c0873181647cc75bb6d54a494aa1942f1e2.png" alt="Cover bg">
</a></div>
<div class="bookInfo">
<h1>
Ruby on Rails Tutorial (Rails 5)
<span class="j_subtitle">Learn Web Development with Rails</span>
<strong class="book-author-name">Michael Hartl</strong>
</h1>
<p class="j_description">
 Newly updated for Rails 5, the Ruby on Rails Tutorial book and 
screencast series teach you how to develop and deploy real, 
industrial-strength web applications with Ruby on Rails, the open-source
 web framework that powers top websites such as Twitter, Hulu, GitHub, 
and the Yellow Pages. The Ruby on Rails Tutorial book is available for 
free online and is available for purchase as an ebook (PDF, EPUB, and 
MOBI formats). The companion screencast series includes 14 individual 
lessons, one for each chapter of the Ruby on Rails Tutorial book. 

</p>

<div class="bookControls">
<a href="https://www.railstutorial.org/"><button class="transBG">Book Info</button>
</a><a href="mailto:admin@railstutorial.org"><button class="transBG">Contact Author</button>
</a></div>

</div>

</div>
</div>

<div id="bookMenu" class="bookMenuFixed">
<div class="side-menu" id="book-side">
<div class="side-menu-toggle">
<a class="side-menu-close" onclick="$('.page-book').addClass('side-menu-closed')" href="javascript://"><svg class="svg-inline--fa fa-times fa-w-11" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="times" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 352 512" data-fa-i2svg=""><path fill="currentColor" d="M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"></path></svg><!-- <i class="fas fa-times"></i> -->
</a><a class="side-menu-open" onclick="$('.page-book').removeClass('side-menu-closed')" href="javascript://"><svg class="svg-inline--fa fa-bars fa-w-14" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="bars" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" data-fa-i2svg=""><path fill="currentColor" d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg><!-- <i class="fas fa-bars"></i> -->
</a></div>
<div class="le-book-promo">
<img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/logo_shield_b-7be3bbe072c03d6cb05d124789361513ce241a2d1fc123.png" alt="Logo shield b">
<div class="le-book-note">
<div>New to software development?</div>
We want to teach you the single most valuable skill you can learn in the 21st century. Read the
<a href="http://www.learnenough.com/story">Learn Enough Story</a>
to find out more.
</div>
<header>
<a href="http://www.learnenough.com/story"><button>Start Learning Now</button>
</a></header>
</div>
<ul><li><a>Frontmatter</a></li><li><a>Chapter 1: From zero to deploy</a></li><li><a>Chapter 2: A toy app</a></li><li><a>Chapter 3: Mostly static pages</a></li><li><a>Chapter 4: Rails-flavored Ruby</a></li><li><a>Chapter 5: Filling in the layout</a></li><li><a>Chapter 6: Modeling users</a></li><li><a>Chapter 7: Sign up</a></li><li><a>Chapter 8: Basic login</a></li><li><a>Chapter 9: Advanced login</a></li><li><a>Chapter 10: Updating, showing, and deleting users</a></li><li><a>Chapter 11: Account activation</a></li><li><a>Chapter 12: Password reset</a></li><li><a>Chapter 13: User microposts</a></li><li><a>Chapter 14: Following users</a></li></ul>
</div>
<div class="bookMenu-actions j_downloadLinks"><a onclick="$('#bookMenuEmail').toggleClass('open'); return false" class="buttonStyle greyButton iEmailUpdate" href=""><svg class="svg-inline--fa fa-heart fa-w-16" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="heart" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M462.3 62.6C407.5 15.9 326 24.3 275.7 76.2L256 96.5l-19.7-20.3C186.1 24.3 104.5 15.9 49.7 62.6c-62.8 53.6-66.1 149.8-9.9 207.9l193.5 199.8c12.5 12.9 32.8 12.9 45.3 0l193.5-199.8c56.3-58.1 53-154.3-9.8-207.9z"></path></svg><!-- <i class="fas fa-heart"></i> -->
Mailing List
</a><a class="buttonStyle attention" href="https://www.railstutorial.org/#pricing">Buy Now</a>
</div>
<div class="bookMenuSearch">
<a id="j_singlePage" href="javascript://"><svg class="svg-inline--fa fa-search fa-w-16" aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" data-fa-i2svg=""><path fill="currentColor" d="M505 442.7L405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c48.3 0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9 0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7 0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7 0 128 57.2 128 128 0 70.7-57.2 128-128 128z"></path></svg><!-- <i class="fas fa-search"></i> -->
Single Page
</a></div>
<div class="bookMenu-arrows">
<a class="leftArrow" href="javascript://"></a>
<a class="upArrow" href="javascript://"></a>
<a class="rightArrow" href="javascript://"></a>
<div id="chapter-title">Chapter 7: Sign up</div>
</div>
<div id="bookMenuEmail">
<label>Get a free 8-part email course &amp; priority notifications about the Ruby on Rails Tutorial &amp; related products.</label>

<div class="j_followBookForm"><div id="j_bookFollowForm">
<form action="https://www.softcover.io/books/216/follow" accept-charset="UTF-8" data-remote="true" method="get"><input name="utf8" type="hidden" value="">
<!-- %input{name: "name", type: "text", placeholder: "YOUR NAME"} -->
<input name="email" placeholder="Your email address" type="text">
<input class="greyButton optClick_follow" data-disable-with="Submitting..." type="submit" value="Follow Author">
</form>

<p id="j_bookFollowNotice" style="display:none"></p>
</div>
</div>
</div>
</div>

<div class="book-wr">
<div id="bookHtml" style="opacity: 1;">
<div id="book"><div class="book"><div id="_cha-sign_up" data-tralics-id="cid37" class="chapter" data-number="7" data-chapter="sign_up"><h1><a href="https://www.railstutorial.org/book/sign_up#cha-sign_up" class="heading hyperref"><span class="number">Chapter 7 </span>Sign up</a></h1>
<p> <span class="free"></span></p>
<p>Now that we have a working User model, its time to add an ability few websites can live without: letting users sign up.<span class="intersentencespace"></span> Well use an HTML <em>form</em> to submit user signup information to our application (<a href="https://www.railstutorial.org/book/sign_up#sec-signup_form" class="hyperref">Section&nbsp;<span class="ref">7.2</span></a>), which will then be used to create a new user and save its attributes to the database (<a href="https://www.railstutorial.org/book/sign_up#sec-successful_signups" class="hyperref">Section&nbsp;<span class="ref">7.4</span></a>).<span class="intersentencespace"></span>
 At the end of the signup process, its important to render a profile 
page with the newly created users information, so well begin by making
 a page for <em>showing</em> users, which will serve as the first step toward implementing the REST architecture for users (<a href="https://www.railstutorial.org/book/toy_app#sec-mvc_in_action" class="hyperref">Section&nbsp;<span class="ref">2.2.2</span></a>).<span class="intersentencespace"></span> Along the way, well build on our work in <a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-layout_link_tests" class="hyperref">Section&nbsp;<span class="ref">5.3.4</span></a> to write succinct and expressive integration tests.</p>
<p>In this chapter, well rely on the User model validations from <a href="https://www.railstutorial.org/book/modeling_users#cha-modeling_users" class="hyperref">Chapter&nbsp;<span class="ref">6</span></a> to increase the odds of new users having valid email addresses.<span class="intersentencespace"></span> In <a href="https://www.railstutorial.org/book/account_activation#cha-account_activation" class="hyperref">Chapter&nbsp;<span class="ref">11</span></a>, well make <em>sure</em> of email validity by adding a separate <em>account activation</em> step to user signup.</p>
<p>Although this tutorial is designed to be as simple as possible while 
still being professional-grade, web development is a complicated 
subject, and <a href="https://www.railstutorial.org/book/sign_up#cha-sign_up" class="hyperref">Chapter&nbsp;<span class="ref">7</span></a> necessarily marks a significant increase in the difficulty of the exposition.<span class="intersentencespace"></span> I recommend taking your time with the material and reviewing it as necessary.<span class="intersentencespace"></span> (Some readers have reported simply doing the chapter twice is a helpful exercise.)<span class="intersentencespace"></span> You might also consider joining the <a href="https://www.learnenough.com/story" target="_blank" rel="noopener">Learn Enough Society</a> to gain additional assistance, both with this tutorial and with its relevant prerequisites (especially <a href="https://www.learnenough.com/ruby" target="_blank" rel="noopener"><em>Learn Enough Ruby to Be Dangerous</em></a>).</p>
</div><div id="_sec-showing_users" data-tralics-id="cid38" class="section" data-number="7.1"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-showing_users" class="heading hyperref"><span class="number">7.1 </span>Showing users</a></h2>
<p>In this section, well take the first steps toward the final profile 
by making a page to display a users name and profile photo, as 
indicated by the mockup in <a href="https://www.railstutorial.org/book/sign_up#fig-profile_mockup_profile_name" class="hyperref">Figure&nbsp;<span class="ref">7.1</span></a>.<sup id="_cha-7_footnote-ref-1" class="footnote"><a href="#cha-7_footnote-1">1</a></sup><span class="intersentencespace"></span>
 Our eventual goal for the user profile pages is to show the users 
profile image, basic user data, and a list of microposts, as mocked up 
in <a href="https://www.railstutorial.org/book/sign_up#fig-profile_mockup" class="hyperref">Figure&nbsp;<span class="ref">7.2</span></a>.<sup id="_cha-7_footnote-ref-2" class="footnote"><a href="#cha-7_footnote-2">2</a></sup><span class="intersentencespace"></span> (<a href="https://www.railstutorial.org/book/sign_up#fig-profile_mockup" class="hyperref">Figure&nbsp;<span class="ref">7.2</span></a> has our first example of <em>lorem ipsum</em> text, which has a <a href="http://www.straightdope.com/columns/read/2290/what-does-the-filler-text-lorem-ipsum-mean" target="_blank" rel="noopener">fascinating story</a> that you should definitely read about some time.)<span class="intersentencespace"></span> Well complete this task, and with it the sample application, in <a href="https://www.railstutorial.org/book/following_users#cha-following_users" class="hyperref">Chapter&nbsp;<span class="ref">14</span></a>.</p>
<p>If youre following along with version control, make a topic branch as usual:</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> git checkout -b sign-up
</pre></div></div>
<div class="center figure" id="_fig-profile_mockup_profile_name" data-tralics-id="uid820" data-number="7.1">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/profile_mockup_profile_name_bootstrap.png" alt="images/figures/profile_mockup_profile_name_bootstrap"></div><div class="caption"><span class="header">Figure 7.1: </span><span class="description">A mockup of the user profile made in this section.
</span></div></div>
<div class="center figure" id="_fig-profile_mockup" data-tralics-id="uid821" data-number="7.2">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/profile_mockup_bootstrap.png" alt="images/figures/profile_mockup_bootstrap"></div><div class="caption"><span class="header">Figure 7.2: </span><span class="description">A mockup of our best guess at the final profile page.
</span></div></div>
<div id="_sec-rails_environments" data-tralics-id="uid822" class="subsection" data-number="7.1.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-rails_environments" class="heading hyperref"><span class="number">7.1.1 </span>Debug and Rails environments</a></h3>
<p>The profiles in this section will be the first truly dynamic pages in our application.<span class="intersentencespace"></span>
 Although the view will exist as a single page of code, each profile 
will be customized using information retrieved from the applications 
database.<span class="intersentencespace"></span> As preparation for 
adding dynamic pages to our sample application, now is a good time to 
add some debug information to our site layout (<a href="https://www.railstutorial.org/book/sign_up#code-rails_debug" class="hyperref">Listing&nbsp;<span class="ref">7.1</span></a>).<span class="intersentencespace"></span> This displays some useful information about each page using the built-in <code>debug</code> method and <code>params</code> variable (which well learn more about in <a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="hyperref">Section&nbsp;<span class="ref">7.1.2</span></a>).</p>
<div class="codelisting" id="_code-rails_debug" data-tralics-id="uid823" data-number="7.1"><div class="heading"><span class="number">Listing 7.1:</span> 

<span class="description">Adding some debug information to the site layout.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/layouts/application.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  .
  .
  .
  <span class="nt">&lt;body&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/header'</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/footer'</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">debug</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">development?</span> <span class="cp">%&gt;</span>
</span>    <span class="nt">&lt;/div&gt;</span>
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div><p>Since we dont want to display debug information to users of a deployed application, <a href="https://www.railstutorial.org/book/sign_up#code-rails_debug" class="hyperref">Listing&nbsp;<span class="ref">7.1</span></a> uses</p>
<div class="code"><div class="highlight"><pre><span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">development?</span>
</pre></div></div>
<p>to restrict the debug information to the <em>development environment</em>, which is one of three environments defined by default in Rails (<a href="https://www.railstutorial.org/book/sign_up#aside-rails_environments" class="hyperref">Box&nbsp;<span class="ref">7.1</span></a>).<sup id="_cha-7_footnote-ref-3" class="footnote"><a href="#cha-7_footnote-3">3</a></sup><span class="intersentencespace"></span> In particular, <code>Rails.env.development?</code> is <code>true</code> only in a development environment, so the embedded Ruby</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">debug</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">development?</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>wont be inserted into production applications or tests.<span class="intersentencespace"></span>
 (Inserting the debug information into tests probably wouldnt do any 
harm, but it probably wouldnt do any good, either, so its best to 
restrict the debug display to development only.)</p>
<div class="aside" id="_aside-rails_environments" data-tralics-id="uid825" data-number="7.1"><div class="heading"><span class="number">Box 7.1.</span> 

<span class="description">Rails environments</span></div>
<p>Rails comes equipped with three environments: <code class="tt">test</code>, <code class="tt">development</code>, and <code class="tt">production</code>.<span class="intersentencespace"></span> The default environment for the Rails console is <code class="tt">development</code>:</p>
<pre>  $ rails console
  Loading development environment
  &gt;&gt; Rails.env
  =&gt; "development"
  &gt;&gt; Rails.env.development?
  =&gt; true
  &gt;&gt; Rails.env.test?
  =&gt; false</pre>
<p>As you can see, Rails provides a <code class="tt">Rails</code> object with an <code class="tt">env</code> attribute and associated environment boolean methods, so that, for example, <code class="tt">Rails.env.test?</code> returns <code class="tt">true</code> in a test environment and <code class="tt">false</code> otherwise.</p>
<p>If you ever need to run a console in a different environment (to 
debug a test, for example), you can pass the environment as a parameter 
to the <code class="tt">console</code> script:</p>
<pre>  $ rails console test
  Loading test environment
  &gt;&gt; Rails.env
  =&gt; "test"
  &gt;&gt; Rails.env.test?
  =&gt; true</pre>
<p>As with the console, <code class="tt">development</code> is the default environment for the Rails server, but you can also run it in a different environment:</p>
<pre>  $ rails server --environment production</pre>
<p>If you view your app running in production, it wont work without a production database, which we can create by running <code class="tt">rails db:migrate</code> in production:</p>
<pre>  $ rails db:migrate RAILS_ENV=production</pre>
<p>(I find it confusing that the idiomatic commands to run the console, 
server, and migrate commands in non-default environments use different 
syntax, which is why I bothered showing all three.<span class="intersentencespace"></span> Its worth noting, though, that preceding any of them with <code class="tt">RAILS_ENV=&lt;env&gt;</code> will also work, as in <code class="tt">RAILS_ENV=production rails server</code>).</p>
<p>By the way, if you have deployed your sample app to Heroku, you can see its environment using <code class="tt">heroku run rails console</code>:</p>
<pre>  $ heroku run rails console
  &gt;&gt; Rails.env
  =&gt; "production"
  &gt;&gt; Rails.env.production?
  =&gt; true</pre>
<p>Naturally, since Heroku is a platform for production sites, it runs each application in a production environment.<span class="intersentencespace"></span></p>

</div><p>To make the debug output look nice, well add some rules to the custom stylesheet created in <a href="https://www.railstutorial.org/book/filling_in_the_layout#cha-filling_in_the_layout" class="hyperref">Chapter&nbsp;<span class="ref">5</span></a>, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-mixin_and_debug" class="hyperref">Listing&nbsp;<span class="ref">7.2</span></a>.</p>
<div class="codelisting" id="_code-mixin_and_debug" data-tralics-id="uid826" data-number="7.2"><div class="heading"><span class="number">Listing 7.2:</span> 

<span class="description">Adding code for a pretty debug box, including a Sass mixin.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/assets/stylesheets/custom.scss</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">@import</span> <span class="s2">"bootstrap-sprockets"</span><span class="p">;</span>
<span class="k">@import</span> <span class="s2">"bootstrap"</span><span class="p">;</span>

<span class="cm">/* mixins, variables, etc. */</span>

<span class="nv">$gray-medium-light</span><span class="o">:</span> <span class="mh">#eaeaea</span><span class="p">;</span>

<span class="hll"><span class="k">@mixin</span><span class="nf"> box_sizing</span> <span class="p">{</span>
</span><span class="hll">  <span class="na">-moz-box-sizing</span><span class="o">:</span>    <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
</span><span class="hll">  <span class="na">-webkit-box-sizing</span><span class="o">:</span> <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
</span><span class="hll">  <span class="na">box-sizing</span><span class="o">:</span>         <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
</span><span class="hll"><span class="p">}</span>
</span><span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="hll"><span class="o">/*</span> <span class="nt">miscellaneous</span> <span class="o">*/</span>
</span>
<span class="hll"><span class="nc">.debug_dump</span> <span class="p">{</span>
</span><span class="hll">  <span class="na">clear</span><span class="o">:</span> <span class="no">both</span><span class="p">;</span>
</span><span class="hll">  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
</span><span class="hll">  <span class="na">width</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
</span><span class="hll">  <span class="na">margin-top</span><span class="o">:</span> <span class="mi">45</span><span class="kt">px</span><span class="p">;</span>
</span><span class="hll">  <span class="k">@include</span><span class="nd"> box_sizing</span><span class="p">;</span>
</span><span class="hll"><span class="p">}</span>
</span></pre></div></div></div><p>This introduces the Sass <em>mixin</em> facility, in this case called <code>box_sizing</code>.<span class="intersentencespace"></span> A mixin allows a group of CSS rules to be packaged up and used for multiple elements, converting</p>
<div class="code"><div class="highlight"><pre><span class="nc">.debug_dump</span> <span class="p">{</span>
  <span class="nc">.</span>
  <span class="nc">.</span>
  <span class="nc">.</span>
  <span class="o">@</span><span class="nt">include</span> <span class="nt">box_sizing</span><span class="o">;</span>
<span class="p">}</span>
</pre></div></div>
<p>to</p>
<div class="code"><div class="highlight"><pre><span class="nc">.debug_dump</span> <span class="p">{</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">.</span>
  <span class="na">-moz-box-sizing</span><span class="o">:</span>    <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
  <span class="na">-webkit-box-sizing</span><span class="o">:</span> <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
  <span class="na">box-sizing</span><span class="o">:</span>         <span class="no">border</span><span class="o">-</span><span class="n">box</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div>
<p>Well put this mixin to use again in <a href="https://www.railstutorial.org/book/sign_up#sec-using_form_for" class="hyperref">Section&nbsp;<span class="ref">7.2.1</span></a>.<span class="intersentencespace"></span> The result in the case of the debug box is shown in <a href="https://www.railstutorial.org/book/sign_up#fig-home_page_with_debug" class="hyperref">Figure&nbsp;<span class="ref">7.3</span></a>.<sup id="_cha-7_footnote-ref-4" class="footnote"><a href="#cha-7_footnote-4">4</a></sup></p>
<div class="center figure" id="_fig-home_page_with_debug" data-tralics-id="uid828" data-number="7.3">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/home_page_with_debug_3rd_edition.png" alt="images/figures/home_page_with_debug_3rd_edition"></div><div class="caption"><span class="header">Figure 7.3: </span><span class="description">The sample application Home page with debug information.
</span></div></div>
<p>The debug output in <a href="https://www.railstutorial.org/book/sign_up#fig-home_page_with_debug" class="hyperref">Figure&nbsp;<span class="ref">7.3</span></a> gives potentially useful information about the page being rendered:</p>
<div class="code"><div class="highlight"><pre><span class="nn">---</span>
<span class="l-Scalar-Plain">controller</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">static_pages</span>
<span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">home</span>
</pre></div></div>
<p>This is a YAML<sup id="_cha-7_footnote-ref-5" class="footnote"><a href="#cha-7_footnote-5">5</a></sup> representation of <code>params</code>, which is basically a hash, and in this case identifies the controller and action for the page.<span class="intersentencespace"></span> Well see another example in <a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="hyperref">Section&nbsp;<span class="ref">7.1.2</span></a>.</p>
<div id="_sec-exercises_rails_environments" data-tralics-id="uid830" class="subsubsection" data-number="7.1.1.1"><h4><a href="#sec-exercises_rails_environments" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Visit /about in your browser and use the debug information to determine the controller and action of the <code>params</code> hash. <span class="exercise" id="ex-4fe125"></span>
</li>
<li>In the Rails console, pull the first user out of the database and assign it to the variable <code>user</code>.<span class="intersentencespace"></span> What is the output of <code>puts user.attributes.to_yaml</code>?<span class="intersentencespace"></span> Compare this to using the <code>y</code> method via <code>y user.attributes</code>. <span class="exercise" id="ex-ab8c3e"></span>
</li></ol>
</div></div>
<div id="_sec-a_users_resource" data-tralics-id="uid833" class="subsection" data-number="7.1.2"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="heading hyperref"><span class="number">7.1.2 </span>A Users resource</a></h3>
<p>In order to make a user profile page, we need to have a user in the 
database, which introduces a chicken-and-egg problem: how can the site 
have a user before there is a working signup page?<span class="intersentencespace"></span> Happily, this problem has already been solved: in <a href="https://www.railstutorial.org/book/modeling_users#sec-creating_and_authenticating_a_user" class="hyperref">Section&nbsp;<span class="ref">6.3.4</span></a>, we created a User record by hand using the Rails console, so there should be one user in the database:</p>
<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="no">User</span><span class="o">.</span><span class="n">count</span>
<span class="go">=&gt; 1</span>
<span class="gp">&gt;&gt; </span><span class="no">User</span><span class="o">.</span><span class="n">first</span>
<span class="go">=&gt; #&lt;User id: 1, name: "Michael Hartl", email: "mhartl@example.com",</span>
<span class="go">created_at: "2016-05-23 20:36:46", updated_at: "2016-05-23 20:36:46",</span>
<span class="go">password_digest: "$2a$10$xxucoRlMp06RLJSfWpZ8hO8Dt9AZXlGRi3usP3njQg3..."&gt;</span>
</pre></div></div>
<p>(If you dont currently have a user in your database, you should visit <a href="https://www.railstutorial.org/book/modeling_users#sec-creating_and_authenticating_a_user" class="hyperref">Section&nbsp;<span class="ref">6.3.4</span></a> now and complete it before proceeding.)<span class="intersentencespace"></span> We see from the console output above that the user has id&nbsp;<code>1</code>, and our goal now is to make a page to display this users information.<span class="intersentencespace"></span> Well follow the conventions of the REST architecture favored in Rails applications (<a href="https://www.railstutorial.org/book/toy_app#aside-REST" class="hyperref">Box&nbsp;<span class="ref">2.2</span></a>), which means representing data as <em>resources</em> that can be created, shown, updated, or destroyedfour actions corresponding to the four fundamental operations <code class="tt">POST</code>, <code class="tt">GET</code>, <code class="tt">PATCH</code>, and <code class="tt">DELETE</code> defined by the <a href="https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol" target="_blank" rel="noopener">HTTP standard</a> (<a href="https://www.railstutorial.org/book/static_pages#aside-get_etc" class="hyperref">Box&nbsp;<span class="ref">3.2</span></a>).</p>
<p>When following REST principles, resources are typically referenced using the resource name and a unique identifier.<span class="intersentencespace"></span> What this means in the context of userswhich were now thinking of as a Users <em>resource</em>is that we should view the user with id&nbsp;<code>1</code> by issuing a <code class="tt">GET</code> request to the URL /users/1.<span class="intersentencespace"></span> Here the <code>show</code> action is <em>implicit</em> in the type of requestwhen Rails REST features are activated, <code class="tt">GET</code> requests are automatically handled by the <code>show</code> action.</p>
<p>We saw in <a href="https://www.railstutorial.org/book/toy_app#sec-a_user_tour" class="hyperref">Section&nbsp;<span class="ref">2.2.1</span></a> that the page for a user with id&nbsp;<code>1</code> has URL /users/1.<span class="intersentencespace"></span> Unfortunately, visiting that URL right now just gives an error, as seen in the server log (<a href="https://www.railstutorial.org/book/sign_up#fig-profile_routing_error" class="hyperref">Figure&nbsp;<span class="ref">7.4</span></a>).</p>
<div class="center figure" id="_fig-profile_routing_error" data-tralics-id="uid834" data-number="7.4">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/profile_routing_error_4th_edition.png" alt="images/figures/profile_routing_error_4th_edition"></div><div class="caption"><span class="header">Figure 7.4: </span><span class="description">The server log error for /users/1.
</span></div></div>
<p>We can get the routing for /users/1 to work by adding a single line to our routes file (<code>config/routes.rb</code>):</p>
<div class="code"><div class="highlight"><pre><span class="n">resources</span> <span class="ss">:users</span>
</pre></div></div>
<p>The result appears in <a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>.</p>
<div class="codelisting" id="_code-users_resource" data-tralics-id="uid835" data-number="7.3"><div class="heading"><span class="number">Listing 7.3:</span> 

<span class="description">Adding a Users resource to the routes file.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">config/routes.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
  <span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span>    <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span>
  <span class="n">get</span>  <span class="s1">'/about'</span><span class="p">,</span>   <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#about'</span>
  <span class="n">get</span>  <span class="s1">'/contact'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#contact'</span>
  <span class="n">get</span>  <span class="s1">'/signup'</span><span class="p">,</span>  <span class="ss">to</span><span class="p">:</span> <span class="s1">'users#new'</span>
<span class="hll">  <span class="n">resources</span> <span class="ss">:users</span>
</span><span class="k">end</span>
</pre></div></div></div><p>Although our immediate motivation is making a page to show users, the single line <code>resources :users</code> doesnt just add a working /users/1 URL; it endows our sample application with <em>all</em> the actions needed for a RESTful Users resource,<sup id="_cha-7_footnote-ref-6" class="footnote"><a href="#cha-7_footnote-6">6</a></sup> along with a large number of named routes (<a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-named_routes" class="hyperref">Section&nbsp;<span class="ref">5.3.3</span></a>) for generating user URLs.<span class="intersentencespace"></span> The resulting correspondence of URLs, actions, and named routes is shown in <a href="https://www.railstutorial.org/book/sign_up#table-RESTful_users" class="hyperref">Table&nbsp;<span class="ref">7.1</span></a>.<span class="intersentencespace"></span> (Compare to <a href="https://www.railstutorial.org/book/toy_app#table-demo_RESTful_users" class="hyperref">Table&nbsp;<span class="ref">2.2</span></a>.)<span class="intersentencespace"></span> Over the course of the next three chapters, well cover all of the other entries in <a href="https://www.railstutorial.org/book/sign_up#table-RESTful_users" class="hyperref">Table&nbsp;<span class="ref">7.1</span></a> as we fill in all the actions necessary to make Users a fully RESTful resource.</p>
<div class="table" id="_table-RESTful_users" data-tralics-id="uid837" data-number="7.1"><table class="tabular">
<tbody><tr class="bottom_border"><td class="align_left"><strong>HTTP request</strong></td>
<td class="align_left"><strong>URL</strong></td>
<td class="align_left"><strong>Action</strong></td>
<td class="align_left"><strong>Named route</strong></td>
<td class="align_left"><strong>Purpose</strong></td>
</tr><tr><td class="align_left"><code class="tt">GET</code></td>
<td class="align_left">/users</td>
<td class="align_left"><code>index</code></td>
<td class="align_left"><code>users_path</code></td>
<td class="align_left">page to list all users</td>
</tr><tr><td class="align_left"><code class="tt">GET</code></td>
<td class="align_left">/users/1</td>
<td class="align_left"><code>show</code></td>
<td class="align_left"><code>user_path(user)</code></td>
<td class="align_left">page to show user</td>
</tr><tr><td class="align_left"><code class="tt">GET</code></td>
<td class="align_left">/users/new</td>
<td class="align_left"><code>new</code></td>
<td class="align_left"><code>new_user_path</code></td>
<td class="align_left">page to make a new user (signup)</td>
</tr><tr><td class="align_left"><code class="tt">POST</code></td>
<td class="align_left">/users</td>
<td class="align_left"><code>create</code></td>
<td class="align_left"><code>users_path</code></td>
<td class="align_left">create a new user</td>
</tr><tr><td class="align_left"><code class="tt">GET</code></td>
<td class="align_left">/users/1/edit</td>
<td class="align_left"><code>edit</code></td>
<td class="align_left"><code>edit_user_path(user)</code></td>
<td class="align_left">page to edit user with id <code>1</code></td>
</tr><tr><td class="align_left"><code class="tt">PATCH</code></td>
<td class="align_left">/users/1</td>
<td class="align_left"><code>update</code></td>
<td class="align_left"><code>user_path(user)</code></td>
<td class="align_left">update user</td>
</tr><tr><td class="align_left"><code class="tt">DELETE</code></td>
<td class="align_left">/users/1</td>
<td class="align_left"><code>destroy</code></td>
<td class="align_left"><code>user_path(user)</code></td>
<td class="align_left">delete user</td>
</tr></tbody></table><div class="caption"><span class="header">Table 7.1: </span><span class="description">RESTful routes provided by the Users resource in <a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>.
</span></div></div>
<p>With the code in <a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>, the routing works, but theres still no page there (<a href="https://www.railstutorial.org/book/sign_up#fig-user_show_unknown_action" class="hyperref">Figure&nbsp;<span class="ref">7.5</span></a>).<span class="intersentencespace"></span> To fix this, well begin with a minimalist version of the profile page, which well flesh out in <a href="https://www.railstutorial.org/book/sign_up#sec-a_gravatar_image" class="hyperref">Section&nbsp;<span class="ref">7.1.4</span></a>.</p>
<div class="center figure" id="_fig-user_show_unknown_action" data-tralics-id="uid838" data-number="7.5">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/user_show_unknown_action_3rd_edition.png" alt="images/figures/user_show_unknown_action_3rd_edition"></div><div class="caption"><span class="header">Figure 7.5: </span><span class="description">The URL /users/1 with routing but no page.
</span></div></div>
<p>Well use the standard Rails location for showing a user, which is <code>app/views/users/show.html.erb</code>.<span class="intersentencespace"></span> Unlike the <code>new.html.erb</code> view, which we created with the generator in <a href="https://www.railstutorial.org/book/filling_in_the_layout#code-generate_users_controller" class="hyperref">Listing&nbsp;<span class="ref">5.38</span></a>, the <code>show.html.erb</code> file doesnt currently exist, so youll have to create it by hand,<sup id="_cha-7_footnote-ref-7" class="footnote"><a href="#cha-7_footnote-7">7</a></sup> and then fill it with the content shown in <a href="https://www.railstutorial.org/book/sign_up#code-stub_user_view" class="hyperref">Listing&nbsp;<span class="ref">7.4</span></a>.</p>
<div class="codelisting" id="_code-stub_user_view" data-tralics-id="uid840" data-number="7.4"><div class="heading"><span class="number">Listing 7.4:</span> 

<span class="description">A stub view for showing user information.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/users/show.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span> <span class="cp">%&gt;</span>, <span class="cp">&lt;%=</span> <span class="vi">@user</span><span class="o">.</span><span class="n">email</span> <span class="cp">%&gt;</span>
</pre></div></div></div><p>This view uses embedded Ruby to display the 
users name and email address, assuming the existence of an instance 
variable called <code>@user</code>.<span class="intersentencespace"></span> Of course, eventually the real user show page will look very different (and wont display the email address publicly).</p>
<p>In order to get the user show view to work, we need to define an <code>@user</code> variable in the corresponding <code>show</code> action in the Users controller.<span class="intersentencespace"></span> As you might expect, we use the <code>find</code> method on the User model (<a href="https://www.railstutorial.org/book/modeling_users#sec-finding_user_objects" class="hyperref">Section&nbsp;<span class="ref">6.1.4</span></a>) to retrieve the user from the database, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-user_show_action" class="hyperref">Listing&nbsp;<span class="ref">7.5</span></a>.</p>
<div class="codelisting" id="_code-user_show_action" data-tralics-id="uid841" data-number="7.5"><div class="heading"><span class="number">Listing 7.5:</span> 

<span class="description">The Users controller with a <code>show</code> action.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">show</span>
<span class="hll">    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span>  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Here weve used <code>params</code> to retrieve the user&nbsp;id.<span class="intersentencespace"></span> When we make the appropriate request to the Users controller, <code>params[:id]</code> will be the user id&nbsp;<code class="tt">1</code>, so the effect is the same as the <code>find</code> method <code>User.find(1)</code> we saw in <a href="https://www.railstutorial.org/book/modeling_users#sec-finding_user_objects" class="hyperref">Section&nbsp;<span class="ref">6.1.4</span></a>.<span class="intersentencespace"></span> (Technically, <code>params[:id]</code> is the string&nbsp;<code>"1"</code>, but <code>find</code> is smart enough to convert this to an integer.)</p>
<p>With the user view and action defined, the URL /users/1 works perfectly, as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-user_show_rails" class="hyperref">Figure&nbsp;<span class="ref">7.6</span></a>.<span class="intersentencespace"></span> (If you havent restarted the Rails server since adding bcrypt, you may have to do so at this time.<span class="intersentencespace"></span> This sort of thing is a good application of technical sophistication (<a href="https://www.railstutorial.org/book/beginning#aside-technical_sophistication" class="hyperref">Box&nbsp;<span class="ref">1.1</span></a>).)<span class="intersentencespace"></span> Note that the debug information in <a href="https://www.railstutorial.org/book/sign_up#fig-user_show_rails" class="hyperref">Figure&nbsp;<span class="ref">7.6</span></a> confirms the value of <code>params[:id]</code>:</p>
<div class="code"><div class="highlight"><pre><span class="nn">---</span>
<span class="l-Scalar-Plain">action</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">show</span>
<span class="l-Scalar-Plain">controller</span><span class="p-Indicator">:</span> <span class="l-Scalar-Plain">users</span>
<span class="l-Scalar-Plain">id</span><span class="p-Indicator">:</span> <span class="s">'1'</span>
</pre></div></div>
<p>This is why the code</p>
<div class="code"><div class="highlight"><pre><span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</pre></div></div>
<p>in <a href="https://www.railstutorial.org/book/sign_up#code-user_show_action" class="hyperref">Listing&nbsp;<span class="ref">7.5</span></a> finds the user with id&nbsp;<code class="tt">1</code>.</p>
<div class="center figure" id="_fig-user_show_rails" data-tralics-id="uid842" data-number="7.6">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/user_show_3rd_edition.png" alt="images/figures/user_show_3rd_edition"></div><div class="caption"><span class="header">Figure 7.6: </span><span class="description">The user show page after adding a Users resource.
</span></div></div>
<div id="_sec-exercises_a_users_resource" data-tralics-id="uid843" class="subsubsection" data-number="7.1.2.1"><h4><a href="#sec-exercises_a_users_resource" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Using embedded Ruby, add the <code>created_at</code> and <code>updated_at</code> magic column attributes to the user show page from <a href="https://www.railstutorial.org/book/sign_up#code-stub_user_view" class="hyperref">Listing&nbsp;<span class="ref">7.4</span></a>. <span class="exercise" id="ex-3fb238"></span>
</li>
<li>Using embedded Ruby, add <code>Time.now</code> to the user show page.<span class="intersentencespace"></span> What happens when you refresh the browser? <span class="exercise" id="ex-da090a"></span>
</li></ol>
</div></div>
<div id="_sec-debugger" data-tralics-id="uid846" class="subsection" data-number="7.1.3"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-debugger" class="heading hyperref"><span class="number">7.1.3 </span>Debugger</a></h3>
<p>We saw in <a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="hyperref">Section&nbsp;<span class="ref">7.1.2</span></a> how the information in the <code>debug</code>
 could help us understand whats going on in our application, but 
theres also a more direct way to get debugging information using the <code class="tt">byebug</code> gem (<a href="https://www.railstutorial.org/book/static_pages#code-gemfile_sample_app" class="hyperref">Listing&nbsp;<span class="ref">3.2</span></a>).<span class="intersentencespace"></span> To see how it works, we just need to add a line consisting of <code>debugger</code> to our application, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-debugger" class="hyperref">Listing&nbsp;<span class="ref">7.6</span></a>.</p>
<div class="codelisting" id="_code-debugger" data-tralics-id="uid847" data-number="7.6"><div class="heading"><span class="number">Listing 7.6:</span> 

<span class="description">The Users controller with a debugger.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
<span class="hll">    <span class="n">debugger</span>
</span>  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Now, when we visit /users/1, the Rails server shows a <code>byebug</code> prompt:</p>
<div class="code"><div class="highlight"><pre><span class="go">(byebug)</span>
</pre></div></div>
<p>We can treat this like a Rails console, issuing commands to figure out the state of the application:</p>
<div class="code"><div class="highlight"><pre><span class="go">(byebug) @user.name</span>
<span class="go">"Example User"</span>
<span class="go">(byebug) @user.email</span>
<span class="go">"example@railstutorial.org"</span>
<span class="go">(byebug) params[:id]</span>
<span class="go">"1"</span>
</pre></div></div>
<p>To release the prompt and continue execution of the application, press Ctrl-D, then remove the <code>debugger</code> line from the <code>show</code> action (<a href="https://www.railstutorial.org/book/sign_up#code-debugger_removed" class="hyperref">Listing&nbsp;<span class="ref">7.7</span></a>).</p>
<div class="codelisting" id="_code-debugger_removed" data-tralics-id="uid848" data-number="7.7"><div class="heading"><span class="number">Listing 7.7:</span> 

<span class="description">The Users controller with the debugger line removed.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Whenever youre confused about something in a Rails application, its a good practice to put <code>debugger</code> close to the code you think might be causing the trouble.<span class="intersentencespace"></span> Inspecting the state of the system using <code class="tt">byebug</code> is a powerful method for tracking down application errors and interactively debugging your application.</p>
<div id="_sec-exercises_debugger" data-tralics-id="uid849" class="subsubsection" data-number="7.1.3.1"><h4><a href="#sec-exercises_debugger" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>With the <code>debugger</code> in the <code>show</code> action as in <a href="https://www.railstutorial.org/book/sign_up#code-debugger" class="hyperref">Listing&nbsp;<span class="ref">7.6</span></a>, hit /users/1.<span class="intersentencespace"></span> Use <code>puts</code> to display the value of the YAML form of the <code>params</code> hash.<span class="intersentencespace"></span> <em>Hint</em>: Refer to the relevant exercise in <a href="https://www.railstutorial.org/book/sign_up#sec-exercises_rails_environments" class="hyperref">Section&nbsp;<span class="ref">7.1.1.1</span></a>.<span class="intersentencespace"></span> How does it compare to the debug information shown by the <code>debug</code> method in the site template? <span class="exercise" id="ex-8679b1"></span>
</li>
<li>Put the <code>debugger</code> in the User <code>new</code> action and hit /users/new.<span class="intersentencespace"></span> What is the value of <code>@user</code>? <span class="exercise" id="ex-2302af"></span>
</li></ol>
</div></div>
<div id="_sec-a_gravatar_image" data-tralics-id="uid852" class="subsection" data-number="7.1.4"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-a_gravatar_image" class="heading hyperref"><span class="number">7.1.4 </span>A Gravatar image and a sidebar</a></h3>
<p>Having defined a basic user page in the previous section, well now 
flesh it out a little with a profile image for each user and the first 
cut of the user sidebar.<span class="intersentencespace"></span> Well start by adding a globally recognized avatar, or <a href="http://gravatar.com/" target="_blank" rel="noopener">Gravatar</a>, to the user profile.<sup id="_cha-7_footnote-ref-8" class="footnote"><a href="#cha-7_footnote-8">8</a></sup><span class="intersentencespace"></span> Gravatar is a free service that allows users to upload images and associate them with email addresses they control.<span class="intersentencespace"></span>
 As a result, Gravatars are a convenient way to include user profile 
images without going through the trouble of managing image upload, 
cropping, and storage; all we need to do is construct the proper 
Gravatar image URL using the users email address and the corresponding 
Gravatar image will automatically appear.<span class="intersentencespace"></span> (Well learn how to handle custom image upload in <a href="https://www.railstutorial.org/book/user_microposts#sec-micropost_images" class="hyperref">Section&nbsp;<span class="ref">13.4</span></a>.)</p>
<p>Our plan is to define a <code>gravatar_for</code> helper function to return a Gravatar image for a given user, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-user_show_view_with_gravatar" class="hyperref">Listing&nbsp;<span class="ref">7.8</span></a>.</p>
<div class="codelisting" id="_code-user_show_view_with_gravatar" data-tralics-id="uid854" data-number="7.8"><div class="heading"><span class="number">Listing 7.8:</span> 

<span class="description">The user show view with name and Gravatar.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/users/show.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>
  <span class="cp">&lt;%=</span> <span class="n">gravatar_for</span> <span class="vi">@user</span> <span class="cp">%&gt;</span>
  <span class="cp">&lt;%=</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;/h1&gt;</span>
</pre></div></div></div><p>By default, methods defined in any helper file are automatically available in any view, but for convenience well put the <code>gravatar_for</code> method in the file for helpers associated with the Users controller.<span class="intersentencespace"></span> As noted in the <a href="http://en.gravatar.com/site/implement/hash/" target="_blank" rel="noopener">Gravatar documentation</a>, Gravatar URLs are based on an <a href="https://en.wikipedia.org/wiki/MD5" target="_blank" rel="noopener">MD5 hash</a> of the users email address.<span class="intersentencespace"></span> In Ruby, the MD5 hashing algorithm is implemented using the <code>hexdigest</code> method, which is part of the <code>Digest</code> library:</p>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">email</span> <span class="o">=</span> <span class="s2">"MHARTL@example.COM"</span>
<span class="hll"><span class="gp">&gt;&gt; </span><span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">::</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">email</span><span class="o">.</span><span class="n">downcase</span><span class="p">)</span>
</span><span class="go">=&gt; "1fda4469bcbec3badf5418269ffc5968"</span>
</pre></div></div>
<p>Since email addresses are case-insensitive (<a href="https://www.railstutorial.org/book/modeling_users#sec-format_validation" class="hyperref">Section&nbsp;<span class="ref">6.2.4</span></a>) but MD5 hashes are not, weve used the <code>downcase</code> method to ensure that the argument to <code>hexdigest</code> is all lower-case.<span class="intersentencespace"></span> (Because of the email downcasing callback in <a href="https://www.railstutorial.org/book/modeling_users#code-email_downcase" class="hyperref">Listing&nbsp;<span class="ref">6.32</span></a>, this will never make a difference in this tutorial, but its a good practice in case the <code>gravatar_for</code> ever gets used on email addresses from other sources.)<span class="intersentencespace"></span> The resulting <code>gravatar_for</code> helper appears in <a href="https://www.railstutorial.org/book/sign_up#code-gravatar_for_helper" class="hyperref">Listing&nbsp;<span class="ref">7.9</span></a>.</p>
<div class="codelisting" id="_code-gravatar_for_helper" data-tralics-id="uid855" data-number="7.9"><div class="heading"><span class="number">Listing 7.9:</span> 

<span class="description">Defining a <code>gravatar_for</code> helper method.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/helpers/users_helper.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">module</span> <span class="nn">UsersHelper</span>

  <span class="c1"># Returns the Gravatar for the given user.</span>
  <span class="k">def</span> <span class="nf">gravatar_for</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
    <span class="n">gravatar_id</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">::</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">downcase</span><span class="p">)</span>
    <span class="n">gravatar_url</span> <span class="o">=</span> <span class="s2">"https://secure.gravatar.com/avatar/</span><span class="si">#{</span><span class="n">gravatar_id</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">image_tag</span><span class="p">(</span><span class="n">gravatar_url</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"gravatar"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>The code in <a href="https://www.railstutorial.org/book/sign_up#code-gravatar_for_helper" class="hyperref">Listing&nbsp;<span class="ref">7.9</span></a> returns an image tag for the Gravatar with a <code>gravatar</code>
 CSS class and alt text equal to the users name (which is especially 
convenient for sight-impaired users using a screen reader).</p>
<p>The profile page appears as in <a href="https://www.railstutorial.org/book/sign_up#fig-profile_with_gravatar" class="hyperref">Figure&nbsp;<span class="ref">7.7</span></a>, which shows the default Gravatar image, which appears because <code>user@example.com</code> isnt a real email address.<span class="intersentencespace"></span> (In fact, as you can see by visiting it, the <a href="http://www.example.com/" target="_blank" rel="noopener">example.com</a> domain is reserved for examples like this one.)</p>
<div class="center figure" id="_fig-profile_with_gravatar" data-tralics-id="uid856" data-number="7.7">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/profile_with_gravatar_3rd_edition.png" alt="images/figures/profile_with_gravatar_3rd_edition"></div><div class="caption"><span class="header">Figure 7.7: </span><span class="description">The user profile page with the default Gravatar.
</span></div></div>
<p>To get our application to display a custom Gravatar, well use <code>update_attributes</code> (<a href="https://www.railstutorial.org/book/modeling_users#sec-updating_user_objects" class="hyperref">Section&nbsp;<span class="ref">6.1.5</span></a>) to change the users email to something I control:</p>
<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">first</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">update_attributes</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">"Example User"</span><span class="p">,</span>
<span class="gp">?&gt; </span>                       <span class="ss">email</span><span class="p">:</span> <span class="s2">"example@railstutorial.org"</span><span class="p">,</span>
<span class="gp">?&gt; </span>                       <span class="ss">password</span><span class="p">:</span> <span class="s2">"foobar"</span><span class="p">,</span>
<span class="gp">?&gt; </span>                       <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"foobar"</span><span class="p">)</span>
<span class="go">=&gt; true</span>
</pre></div></div>
<p>Here weve assigned the user the email address <code>example@railstutorial.org</code>, which Ive associated with the Rails Tutorial logo, as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-profile_custom_gravatar" class="hyperref">Figure&nbsp;<span class="ref">7.8</span></a>.</p>
<div class="center figure" id="_fig-profile_custom_gravatar" data-tralics-id="uid857" data-number="7.8">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/profile_custom_gravatar_3rd_edition.png" alt="images/figures/profile_custom_gravatar_3rd_edition"></div><div class="caption"><span class="header">Figure 7.8: </span><span class="description">The user show page with a custom Gravatar.
</span></div></div>
<p>The last element needed to complete the mockup from <a href="https://www.railstutorial.org/book/sign_up#fig-profile_mockup_profile_name" class="hyperref">Figure&nbsp;<span class="ref">7.1</span></a> is the initial version of the user sidebar.<span class="intersentencespace"></span> Well implement it using the <code>aside</code> tag, which is used for content (such as sidebars) that complements the rest of the page but can also stand alone.<span class="intersentencespace"></span> We include <code>row</code> and <code>col-md-4</code> classes, which are both part of Bootstrap.<span class="intersentencespace"></span> The code for the modified user show page appears in <a href="https://www.railstutorial.org/book/sign_up#code-user_show_with_sidebar" class="hyperref">Listing&nbsp;<span class="ref">7.10</span></a>.</p>
<div class="codelisting" id="_code-user_show_with_sidebar" data-tralics-id="uid858" data-number="7.10"><div class="heading"><span class="number">Listing 7.10:</span> 

<span class="description">Adding a sidebar to the user <code>show</code> view.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/users/show.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;aside</span> <span class="na">class=</span><span class="s">"col-md-4"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;section</span> <span class="na">class=</span><span class="s">"user_info"</span><span class="nt">&gt;</span>
      <span class="nt">&lt;h1&gt;</span>
        <span class="cp">&lt;%=</span> <span class="n">gravatar_for</span> <span class="vi">@user</span> <span class="cp">%&gt;</span>
        <span class="cp">&lt;%=</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;/h1&gt;</span>
    <span class="nt">&lt;/section&gt;</span>
  <span class="nt">&lt;/aside&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></div></div><p>With the HTML elements and CSS classes in 
place, we can style the profile page (including the sidebar and the 
Gravatar) with the SCSS shown in <a href="https://www.railstutorial.org/book/sign_up#code-sidebar_css" class="hyperref">Listing&nbsp;<span class="ref">7.11</span></a>.<sup id="_cha-7_footnote-ref-9" class="footnote"><a href="#cha-7_footnote-9">9</a></sup><span class="intersentencespace"></span> (Note the nesting of the table CSS rules, which works only because of the Sass engine used by the asset pipeline.)<span class="intersentencespace"></span> The resulting page is shown in <a href="https://www.railstutorial.org/book/sign_up#fig-user_show_sidebar_css" class="hyperref">Figure&nbsp;<span class="ref">7.9</span></a>.</p>
<div class="codelisting" id="_code-sidebar_css" data-tralics-id="uid860" data-number="7.11"><div class="heading"><span class="number">Listing 7.11:</span> 

<span class="description">SCSS for styling the user show page, including the sidebar.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/assets/stylesheets/custom.scss</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">sidebar</span> <span class="o">*/</span>

<span class="nt">aside</span> <span class="p">{</span>
  <span class="nt">section</span><span class="nc">.user_info</span> <span class="p">{</span>
    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nt">section</span> <span class="p">{</span>
    <span class="na">padding</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span> <span class="mi">0</span><span class="p">;</span>
    <span class="na">margin-top</span><span class="o">:</span> <span class="mi">20</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">&amp;</span><span class="nd">:first-child</span> <span class="p">{</span>
      <span class="na">border</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
      <span class="na">padding-top</span><span class="o">:</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">span</span> <span class="p">{</span>
      <span class="na">display</span><span class="o">:</span> <span class="no">block</span><span class="p">;</span>
      <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">line-height</span><span class="o">:</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="nt">h1</span> <span class="p">{</span>
      <span class="na">font-size</span><span class="o">:</span> <span class="mi">1</span><span class="mf">.4</span><span class="kt">em</span><span class="p">;</span>
      <span class="na">text-align</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
      <span class="na">letter-spacing</span><span class="o">:</span> <span class="mi">-1</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">3</span><span class="kt">px</span><span class="p">;</span>
      <span class="na">margin-top</span><span class="o">:</span> <span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.gravatar</span> <span class="p">{</span>
  <span class="na">float</span><span class="o">:</span> <span class="no">left</span><span class="p">;</span>
  <span class="na">margin-right</span><span class="o">:</span> <span class="mi">10</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>

<span class="nc">.gravatar_edit</span> <span class="p">{</span>
  <span class="na">margin-top</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><div class="center figure" id="_fig-user_show_sidebar_css" data-tralics-id="uid861" data-number="7.9">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/user_show_sidebar_css_3rd_edition.png" alt="images/figures/user_show_sidebar_css_3rd_edition"></div><div class="caption"><span class="header">Figure 7.9: </span><span class="description">The user show page with a sidebar and CSS.
</span></div></div>
<div id="_sec-exercises_a_gravatar_image" data-tralics-id="uid862" class="subsubsection" data-number="7.1.4.1"><h4><a href="#sec-exercises_a_gravatar_image" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Associate a Gravatar with your primary email address if you havent already.<span class="intersentencespace"></span> What is the MD5 hash associated with the image? <span class="exercise" id="ex-6e602e"></span>
</li>
<li>Verify that the code in <a href="https://www.railstutorial.org/book/sign_up#code-gravatar_option" class="hyperref">Listing&nbsp;<span class="ref">7.12</span></a> allows the <code>gravatar_for</code> helper defined in <a href="https://www.railstutorial.org/book/sign_up#sec-a_gravatar_image" class="hyperref">Section&nbsp;<span class="ref">7.1.4</span></a> to take an optional <code>size</code> parameter, allowing code like <code>gravatar_for user, size: 50</code> in the view.<span class="intersentencespace"></span> (Well put this improved helper to use in <a href="https://www.railstutorial.org/book/updating_and_deleting_users#sec-users_index" class="hyperref">Section&nbsp;<span class="ref">10.3.1</span></a>.) <span class="exercise" id="ex-8214c8"></span>
</li>
<li>The options hash used in the previous exercise is still commonly used, but as of Ruby 2.0 we can use <em>keyword arguments</em> instead.<span class="intersentencespace"></span> Confirm that the code in <a href="https://www.railstutorial.org/book/sign_up#code-gravatar_keyword" class="hyperref">Listing&nbsp;<span class="ref">7.13</span></a> can be used in place of <a href="https://www.railstutorial.org/book/sign_up#code-gravatar_option" class="hyperref">Listing&nbsp;<span class="ref">7.12</span></a>.<span class="intersentencespace"></span> What are the diffs between the two? <span class="exercise" id="ex-61914e"></span>
</li></ol>
<div class="codelisting" id="_code-gravatar_option" data-tralics-id="uid866" data-number="7.12"><div class="heading"><span class="number">Listing 7.12:</span> 

<span class="description">Adding an options hash in the <code>gravatar_for</code> helper.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/helpers/users_helper.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">module</span> <span class="nn">UsersHelper</span>

  <span class="c1"># Returns the Gravatar for the given user.</span>
<span class="hll">  <span class="k">def</span> <span class="nf">gravatar_for</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">size</span><span class="p">:</span> <span class="mi">80</span> <span class="p">})</span>
</span>    <span class="n">gravatar_id</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">::</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">downcase</span><span class="p">)</span>
<span class="hll">    <span class="n">size</span> <span class="o">=</span> <span class="n">options</span><span class="o">[</span><span class="ss">:size</span><span class="o">]</span>
</span><span class="hll">    <span class="n">gravatar_url</span> <span class="o">=</span> <span class="s2">"https://secure.gravatar.com/avatar/</span><span class="si">#{</span><span class="n">gravatar_id</span><span class="si">}</span><span class="s2">?s=</span><span class="si">#{</span><span class="n">size</span><span class="si">}</span><span class="s2">"</span>
</span>    <span class="n">image_tag</span><span class="p">(</span><span class="n">gravatar_url</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"gravatar"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="_code-gravatar_keyword" data-tralics-id="uid867" data-number="7.13"><div class="heading"><span class="number">Listing 7.13:</span> 

<span class="description">Using keyword arguments in the <code>gravatar_for</code> helper.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/helpers/users_helper.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">module</span> <span class="nn">UsersHelper</span>

  <span class="c1"># Returns the Gravatar for the given user.</span>
<span class="hll">  <span class="k">def</span> <span class="nf">gravatar_for</span><span class="p">(</span><span class="n">user</span><span class="p">,</span> <span class="ss">size</span><span class="p">:</span> <span class="mi">80</span><span class="p">)</span>
</span>    <span class="n">gravatar_id</span> <span class="o">=</span> <span class="no">Digest</span><span class="o">::</span><span class="no">MD5</span><span class="o">::</span><span class="n">hexdigest</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">email</span><span class="o">.</span><span class="n">downcase</span><span class="p">)</span>
    <span class="n">gravatar_url</span> <span class="o">=</span> <span class="s2">"https://secure.gravatar.com/avatar/</span><span class="si">#{</span><span class="n">gravatar_id</span><span class="si">}</span><span class="s2">?s=</span><span class="si">#{</span><span class="n">size</span><span class="si">}</span><span class="s2">"</span>
    <span class="n">image_tag</span><span class="p">(</span><span class="n">gravatar_url</span><span class="p">,</span> <span class="ss">alt</span><span class="p">:</span> <span class="n">user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"gravatar"</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div></div></div></div><div id="_sec-signup_form" data-tralics-id="cid39" class="section" data-number="7.2"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-signup_form" class="heading hyperref"><span class="number">7.2 </span>Signup form</a></h2>
<p>Now that we have a working (though not yet complete) user profile page, were ready to make a signup form for our site.<span class="intersentencespace"></span> We saw in <a href="https://www.railstutorial.org/book/filling_in_the_layout#fig-new_signup_page" class="hyperref">Figure&nbsp;<span class="ref">5.11</span></a> (shown again in <a href="https://www.railstutorial.org/book/sign_up#fig-blank_signup_page_recap" class="hyperref">Figure&nbsp;<span class="ref">7.10</span></a>) that the signup page is currently blank: useless for signing up new users.<span class="intersentencespace"></span> The goal of this section is to start changing this sad state of affairs by producing the signup form mocked up in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_mockup" class="hyperref">Figure&nbsp;<span class="ref">7.11</span></a>.</p>
<div class="center figure" id="_fig-blank_signup_page_recap" data-tralics-id="uid868" data-number="7.10">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/new_signup_page_3rd_edition.png" alt="images/figures/new_signup_page_3rd_edition"></div><div class="caption"><span class="header">Figure 7.10: </span><span class="description">The current state of the signup page /signup.
</span></div></div>
<div class="center figure" id="_fig-signup_mockup" data-tralics-id="uid869" data-number="7.11">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_mockup_bootstrap.png" alt="images/figures/signup_mockup_bootstrap"></div><div class="caption"><span class="header">Figure 7.11: </span><span class="description">A mockup of the user signup page.
</span></div></div>
<div id="_sec-using_form_for" data-tralics-id="uid870" class="subsection" data-number="7.2.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-using_form_for" class="heading hyperref"><span class="number">7.2.1 </span>Using <code class="tt">form_for</code></a></h3>
<p>The heart of the signup page is a <em>form</em> for submitting the relevant signup information (name, email, password, confirmation).<span class="intersentencespace"></span> We can accomplish this in Rails with the <code>form_for</code> helper method, which takes in an Active Record object and builds a form using the objects attributes.</p>
<p>Recalling that the signup page /signup is routed to the <code>new</code> action in the Users controller (<a href="https://www.railstutorial.org/book/filling_in_the_layout#code-signup_route" class="hyperref">Listing&nbsp;<span class="ref">5.43</span></a>), our first step is to create the User object required as an argument to <code>form_for</code>.<span class="intersentencespace"></span> The resulting <code>@user</code> variable definition appears in <a href="https://www.railstutorial.org/book/sign_up#code-new_action_with_user" class="hyperref">Listing&nbsp;<span class="ref">7.14</span></a>.</p>
<div class="codelisting" id="_code-new_action_with_user" data-tralics-id="uid871" data-number="7.14"><div class="heading"><span class="number">Listing 7.14:</span> 

<span class="description">Adding an <code>@user</code> variable to the <code>new</code> action.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
<span class="hll">    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span>
</span>  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>The form itself appears as in <a href="https://www.railstutorial.org/book/sign_up#code-signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.15</span></a>.<span class="intersentencespace"></span> Well discuss it in detail in <a href="https://www.railstutorial.org/book/sign_up#sec-the_form_html" class="hyperref">Section&nbsp;<span class="ref">7.2.2</span></a>, but first lets style it a little with the SCSS in <a href="https://www.railstutorial.org/book/sign_up#code-form_css" class="hyperref">Listing&nbsp;<span class="ref">7.16</span></a>.<span class="intersentencespace"></span> (Note the reuse of the <code>box_sizing</code> mixin from <a href="https://www.railstutorial.org/book/sign_up#code-mixin_and_debug" class="hyperref">Listing&nbsp;<span class="ref">7.2</span></a>.)<span class="intersentencespace"></span> Once these CSS rules have been applied, the signup page appears as in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_form" class="hyperref">Figure&nbsp;<span class="ref">7.12</span></a>.</p>
<div class="codelisting" id="_code-signup_form" data-tralics-id="uid872" data-number="7.15"><div class="heading"><span class="number">Listing 7.15:</span> 

<span class="description">A form to sign up new users.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/users/new.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">'Sign up'</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Sign up<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6 col-md-offset-3"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form_for</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">email_field</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="s2">"Confirmation"</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password_confirmation</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="s2">"Create my account"</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"btn btn-primary"</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></div></div><div class="codelisting" id="_code-form_css" data-tralics-id="uid873" data-number="7.16"><div class="heading"><span class="number">Listing 7.16:</span> 

<span class="description">CSS for the signup form.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/assets/stylesheets/custom.scss</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">forms</span> <span class="o">*/</span>

<span class="nt">input</span><span class="o">,</span> <span class="nt">textarea</span><span class="o">,</span> <span class="nt">select</span><span class="o">,</span> <span class="nc">.uneditable-input</span> <span class="p">{</span>
  <span class="na">border</span><span class="o">:</span> <span class="mi">1</span><span class="kt">px</span> <span class="no">solid</span> <span class="mh">#bbb</span><span class="p">;</span>
  <span class="na">width</span><span class="o">:</span> <span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
  <span class="na">margin-bottom</span><span class="o">:</span> <span class="mi">15</span><span class="kt">px</span><span class="p">;</span>
  <span class="k">@include</span><span class="nd"> box_sizing</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">input</span> <span class="p">{</span>
  <span class="na">height</span><span class="o">:</span> <span class="no">auto</span> <span class="nv">!important</span><span class="p">;</span>
<span class="p">}</span>
</pre></div></div></div><div class="center figure" id="_fig-signup_form" data-tralics-id="uid874" data-number="7.12">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_form_3rd_edition.png" alt="images/figures/signup_form_3rd_edition"></div><div class="caption"><span class="header">Figure 7.12: </span><span class="description">The user signup form.
</span></div></div>
<div id="_sec-exercises_using_form_for" data-tralics-id="uid875" class="subsubsection" data-number="7.2.1.1"><h4><a href="#sec-exercises_using_form_for" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>In <a href="https://www.railstutorial.org/book/sign_up#code-signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.15</span></a>, replace <code>:name</code> with <code>:nome</code>.<span class="intersentencespace"></span> What error message do you get as a result? <span class="exercise" id="ex-7224ab"></span>
</li>
<li>Confirm by replacing all occurrences of <code>f</code> with <code>foobar</code> that the name of the block variable is irrelevant as far as the result is concerned.<span class="intersentencespace"></span> Why might <code>foobar</code> nevertheless be a bad choice? <span class="exercise" id="ex-d0bbfe"></span>
</li></ol>
</div></div>
<div id="_sec-the_form_html" data-tralics-id="uid878" class="subsection" data-number="7.2.2"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-the_form_html" class="heading hyperref"><span class="number">7.2.2 </span>Signup form HTML</a></h3>
<p>To understand the form defined in <a href="https://www.railstutorial.org/book/sign_up#code-signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.15</span></a>, its helpful to break it into smaller pieces.<span class="intersentencespace"></span> Well first look at the outer structure, which consists of embedded Ruby opening with a call to <code>form_for</code> and closing with <code>end</code>:</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">form_for</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
  .
  .
  .
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>The presence of the <code>do</code> keyword indicates that <code>form_for</code> takes a block with one variable, which weve called <code>f</code> (for form).</p>
<p>As is usually the case with Rails helpers, we dont need to know any details about the implementation, but what we <em>do</em> need to know is what the <code>f</code> object does: when called with a method corresponding to an <a href="http://www.w3schools.com/html/html_forms.asp" target="_blank" rel="noopener">HTML form element</a>such as a text field, radio button, or password field<code>f</code> returns code for that element specifically designed to set an attribute of the <code>@user</code> object.<span class="intersentencespace"></span> In other words,</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>creates the HTML needed to make a labeled text field element appropriate for setting the <code>name</code> attribute of a User model.</p>
<p>If you look at the HTML for the generated form by Ctrl-clicking and 
using the inspect element function of your browser, the pages source 
should look something like <a href="https://www.railstutorial.org/book/sign_up#code-signup_form_html" class="hyperref">Listing&nbsp;<span class="ref">7.17</span></a>.<span class="intersentencespace"></span> Lets take a moment to discuss its structure.</p>
<div class="codelisting" id="_code-signup_form_html" data-tralics-id="uid879" data-number="7.17"><div class="heading"><span class="number">Listing 7.17:</span> 

<span class="description">The HTML for the form in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_form" class="hyperref">Figure&nbsp;<span class="ref">7.12</span></a>.</span>
</div>

<div class="code"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">accept-charset=</span><span class="s">"UTF-8"</span> <span class="na">action=</span><span class="s">"/users"</span> <span class="na">class=</span><span class="s">"new_user"</span>
      <span class="na">id=</span><span class="s">"new_user"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"utf8"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"&amp;#x2713;"</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span>
         <span class="na">value=</span><span class="s">"NNb6+J/j46LcrgYUC60wQ2titMuJQ5lLqyAbnbAUkdo="</span> <span class="nt">/&gt;</span>
  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_name"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_name"</span> <span class="na">name=</span><span class="s">"user[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_email"</span><span class="nt">&gt;</span>Email<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_email"</span> <span class="na">name=</span><span class="s">"user[email]"</span> <span class="na">type=</span><span class="s">"email"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_password"</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_password"</span> <span class="na">name=</span><span class="s">"user[password]"</span>
         <span class="na">type=</span><span class="s">"password"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_password_confirmation"</span><span class="nt">&gt;</span>Confirmation<span class="nt">&lt;/label&gt;</span>
  <span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_password_confirmation"</span>
         <span class="na">name=</span><span class="s">"user[password_confirmation]"</span> <span class="na">type=</span><span class="s">"password"</span> <span class="nt">/&gt;</span>

  <span class="nt">&lt;input</span> <span class="na">class=</span><span class="s">"btn btn-primary"</span> <span class="na">name=</span><span class="s">"commit"</span> <span class="na">type=</span><span class="s">"submit"</span>
         <span class="na">value=</span><span class="s">"Create my account"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/form&gt;</span>
</pre></div></div></div><p>Well start with the internal structure of the document.<span class="intersentencespace"></span> Comparing <a href="https://www.railstutorial.org/book/sign_up#code-signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.15</span></a> with <a href="https://www.railstutorial.org/book/sign_up#code-signup_form_html" class="hyperref">Listing&nbsp;<span class="ref">7.17</span></a>, we see that the embedded Ruby</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>produces the HTML</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_name"</span><span class="nt">&gt;</span>Name<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_name"</span> <span class="na">name=</span><span class="s">"user[name]"</span> <span class="na">type=</span><span class="s">"text"</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>while</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">email_field</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>produces the HTML</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_email"</span><span class="nt">&gt;</span>Email<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_email"</span> <span class="na">name=</span><span class="s">"user[email]"</span> <span class="na">type=</span><span class="s">"email"</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>and</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
<span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>produces the HTML</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;label</span> <span class="na">for=</span><span class="s">"user_password"</span><span class="nt">&gt;</span>Password<span class="nt">&lt;/label&gt;</span>
<span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_password"</span> <span class="na">name=</span><span class="s">"user[password]"</span> <span class="na">type=</span><span class="s">"password"</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>As seen in <a href="https://www.railstutorial.org/book/sign_up#fig-filled_in_form" class="hyperref">Figure&nbsp;<span class="ref">7.13</span></a>, text and email fields (<code>type="text"</code> and <code>type="email"</code>) simply display their contents, whereas password fields (<code>type="password"</code>) obscure the input for security purposes, as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-filled_in_form" class="hyperref">Figure&nbsp;<span class="ref">7.13</span></a>.<span class="intersentencespace"></span> (The benefit of using an email field is that some systems treat it differently from a text field; for example, the code <code>type="email"</code> will cause some mobile devices to display a special keyboard optimized for entering email addresses.)</p>
<div class="center figure" id="_fig-filled_in_form" data-tralics-id="uid880" data-number="7.13">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/filled_in_form_bootstrap_3rd_edition.png" alt="images/figures/filled_in_form_bootstrap_3rd_edition"></div><div class="caption"><span class="header">Figure 7.13: </span><span class="description">A filled-in form with <code>text</code> and <code>password</code> fields.
</span></div></div>
<p>As well see in <a href="https://www.railstutorial.org/book/sign_up#sec-successful_signups" class="hyperref">Section&nbsp;<span class="ref">7.4</span></a>, the key to creating a user is the special <code>name</code> attribute in each <code>input</code>:</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_name"</span> <span class="na">name=</span><span class="s">"user[name]"</span> <span class="na">-</span> <span class="na">-</span> <span class="na">-</span> <span class="nt">/&gt;</span>
.
.
.
<span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_password"</span> <span class="na">name=</span><span class="s">"user[password]"</span> <span class="na">-</span> <span class="na">-</span> <span class="na">-</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>These <code>name</code> values allow Rails to construct an initialization hash (via the <code>params</code> variable) for creating users using the values entered by the user, as well see in <a href="https://www.railstutorial.org/book/sign_up#sec-unsuccessful_signups" class="hyperref">Section&nbsp;<span class="ref">7.3</span></a>.</p>
<p>The second important element is the <code>form</code> tag itself.<span class="intersentencespace"></span> Rails creates the <code>form</code> tag using the <code>@user</code> object: because every Ruby object knows its own class (<a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-constructors" class="hyperref">Section&nbsp;<span class="ref">4.4.1</span></a>), Rails figures out that <code>@user</code> is of class <code>User</code>; moreover, since <code>@user</code> is a <em>new</em> user, Rails knows to construct a form with the <code>post</code> method, which is the proper verb for creating a new object (<a href="https://www.railstutorial.org/book/static_pages#aside-get_etc" class="hyperref">Box&nbsp;<span class="ref">3.2</span></a>):</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/users"</span> <span class="na">class=</span><span class="s">"new_user"</span> <span class="na">id=</span><span class="s">"new_user"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
</pre></div></div>
<p>Here the <code>class</code> and <code>id</code> attributes are largely irrelevant; whats important is <code>action="/users"</code> and <code>method="post"</code>.<span class="intersentencespace"></span> Together, these constitute instructions to issue an HTTP <code class="tt">POST</code> request to the /users URL.<span class="intersentencespace"></span> Well see in the next two sections what effects this has.</p>
<p>(You may also have noticed the code that appears just inside the <code>form</code> tag:</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"utf8"</span> <span class="na">type=</span><span class="s">"hidden"</span> <span class="na">value=</span><span class="s">"&amp;#x2713;"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;input</span> <span class="na">name=</span><span class="s">"authenticity_token"</span> <span class="na">type=</span><span class="s">"hidden"</span>
       <span class="na">value=</span><span class="s">"NNb6+J/j46LcrgYUC60wQ2titMuJQ5lLqyAbnbAUkdo="</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>This code, which isnt displayed in the browser, is used internally 
by Rails, so its not important for us to understand what it does.<span class="intersentencespace"></span> Briefly, it uses the Unicode character <code>&amp;#x2713;</code> (a checkmark&nbsp;) to force browsers to submit data using the right character encoding, and then it includes an <em>authenticity token</em>, which Rails uses to thwart an attack called a <em>cross-site request forgery</em> (CSRF).<span class="intersentencespace"></span> Knowing when its OK to ignore details like this is a good mark of technical sophistication (<a href="https://www.railstutorial.org/book/beginning#aside-technical_sophistication" class="hyperref">Box&nbsp;<span class="ref">1.1</span></a>).)<sup id="_cha-7_footnote-ref-10" class="footnote"><a href="#cha-7_footnote-10">10</a></sup></p>
<div id="_sec-exercises_the_form_html" data-tralics-id="uid882" class="subsubsection" data-number="7.2.2.1"><h4><a href="#sec-exercises_the_form_html" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li><a href="https://www.learnenough.com/html" target="_blank" rel="noopener"><em>Learn Enough HTML to Be Dangerous</em></a>, in which all HTML is written by hand, doesnt cover the <code>form</code> tag.<span class="intersentencespace"></span> Why not? <span class="exercise" id="ex-602989"></span>
</li></ol>
</div></div></div><div id="_sec-unsuccessful_signups" data-tralics-id="cid40" class="section" data-number="7.3"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-unsuccessful_signups" class="heading hyperref"><span class="number">7.3 </span>Unsuccessful signups</a></h2>
<p>Although weve briefly examined the HTML for the form in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_form" class="hyperref">Figure&nbsp;<span class="ref">7.12</span></a> (shown in <a href="https://www.railstutorial.org/book/sign_up#code-signup_form_html" class="hyperref">Listing&nbsp;<span class="ref">7.17</span></a>), we havent yet covered any details, and the form is best understood in the context of <em>signup failure</em>.<span class="intersentencespace"></span>
 In this section, well create a signup form that accepts an invalid 
submission and re-renders the signup page with a list of errors, as 
mocked up in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure_mockup" class="hyperref">Figure&nbsp;<span class="ref">7.14</span></a>.</p>
<div class="center figure" id="_fig-signup_failure_mockup" data-tralics-id="uid884" data-number="7.14">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_failure_mockup_bootstrap.png" alt="images/figures/signup_failure_mockup_bootstrap"></div><div class="caption"><span class="header">Figure 7.14: </span><span class="description">A mockup of the signup failure page.
</span></div></div>
<div id="_sec-a_working_form" data-tralics-id="uid885" class="subsection" data-number="7.3.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-a_working_form" class="heading hyperref"><span class="number">7.3.1 </span>A working form</a></h3>
<p>Recall from <a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="hyperref">Section&nbsp;<span class="ref">7.1.2</span></a> that adding <code>resources :users</code> to the <code>routes.rb</code> file (<a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>) automatically ensures that our Rails application responds to the RESTful URLs from <a href="https://www.railstutorial.org/book/sign_up#table-RESTful_users" class="hyperref">Table&nbsp;<span class="ref">7.1</span></a>.<span class="intersentencespace"></span> In particular, it ensures that a <code class="tt">POST</code> request to /users is handled by the <code>create</code> action.<span class="intersentencespace"></span> Our strategy for the <code>create</code> action is to use the form submission to make a new user object using <code>User.new</code>, try (and fail) to save that user, and then render the signup page for possible resubmission.<span class="intersentencespace"></span> Lets get started by reviewing the code for the signup form:</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">"/users"</span> <span class="na">class=</span><span class="s">"new_user"</span> <span class="na">id=</span><span class="s">"new_user"</span> <span class="na">method=</span><span class="s">"post"</span><span class="nt">&gt;</span>
</pre></div></div>
<p>As noted in <a href="https://www.railstutorial.org/book/sign_up#sec-the_form_html" class="hyperref">Section&nbsp;<span class="ref">7.2.2</span></a>, this HTML issues a <code class="tt">POST</code> request to the /users URL.</p>
<p>Our first step toward a working signup form is adding the code in <a href="https://www.railstutorial.org/book/sign_up#code-first_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.18</span></a>.<span class="intersentencespace"></span> This listing includes a second use of the <code>render</code> method, which we first saw in the context of partials (<a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-partials" class="hyperref">Section&nbsp;<span class="ref">5.1.3</span></a>); as you can see, <code>render</code> works in controller actions as well.<span class="intersentencespace"></span> Note that weve taken this opportunity to introduce an <code>if</code>-<code>else</code> branching structure, which allows us to handle the cases of failure and success separately based on the value of <code>@user.save</code>, which (as we saw in <a href="https://www.railstutorial.org/book/modeling_users#sec-creating_user_objects" class="hyperref">Section&nbsp;<span class="ref">6.1.3</span></a>) is either <code>true</code> or <code>false</code> depending on whether or not the save succeeds.</p>
<div class="codelisting" id="_code-first_create_action" data-tralics-id="uid886" data-number="7.18"><div class="heading"><span class="number">Listing 7.18:</span> 

<span class="description">A <code>create</code> action that can handle signup failure.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>

  <span class="k">def</span> <span class="nf">show</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">new</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">create</span>
<span class="hll">    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="p">)</span>    <span class="c1"># Not the final implementation!</span>
</span>    <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">save</span>
      <span class="c1"># Handle a successful save.</span>
    <span class="k">else</span>
      <span class="n">render</span> <span class="s1">'new'</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Note the comment: this is not the final implementation.<span class="intersentencespace"></span> But its enough to get us started, and well finish the implementation in <a href="https://www.railstutorial.org/book/sign_up#sec-strong_parameters" class="hyperref">Section&nbsp;<span class="ref">7.3.2</span></a>.</p>
<p>The best way to understand how the code in <a href="https://www.railstutorial.org/book/sign_up#code-first_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.18</span></a> works is to <em>submit</em> the form with some invalid signup data.<span class="intersentencespace"></span> The result appears in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure" class="hyperref">Figure&nbsp;<span class="ref">7.15</span></a>, and the full debug information appears in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure_rails_debug" class="hyperref">Figure&nbsp;<span class="ref">7.16</span></a>.</p>
<div class="center figure" id="_fig-signup_failure" data-tralics-id="uid887" data-number="7.15">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_failure_4th_edition.png" alt="images/figures/signup_failure_4th_edition"></div><div class="caption"><span class="header">Figure 7.15: </span><span class="description">Signup failure.
</span></div></div>
<div class="center figure" id="_fig-signup_failure_rails_debug" data-tralics-id="uid888" data-number="7.16">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_failure_debug_4th_edition.png" alt="images/figures/signup_failure_debug_4th_edition"></div><div class="caption"><span class="header">Figure 7.16: </span><span class="description">Signup failure debug information.
</span></div></div>
<p>To get a better picture of how Rails handles the submission, lets take a closer look at the <code>user</code> part of the parameters hash from the debug information (<a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure_rails_debug" class="hyperref">Figure&nbsp;<span class="ref">7.16</span></a>):</p>
<div class="code"><div class="highlight"><pre><span class="s2">"user"</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s2">"name"</span> <span class="o">=&gt;</span> <span class="s2">"Foo Bar"</span><span class="p">,</span>
            <span class="s2">"email"</span> <span class="o">=&gt;</span> <span class="s2">"foo@invalid"</span><span class="p">,</span>
            <span class="s2">"password"</span> <span class="o">=&gt;</span> <span class="s2">"[FILTERED]"</span><span class="p">,</span>
            <span class="s2">"password_confirmation"</span> <span class="o">=&gt;</span> <span class="s2">"[FILTERED]"</span>
          <span class="p">}</span>
</pre></div></div>
<p>This hash gets passed to the Users controller as part of <code>params</code>, and we saw starting in <a href="https://www.railstutorial.org/book/sign_up#sec-a_users_resource" class="hyperref">Section&nbsp;<span class="ref">7.1.2</span></a> that the <code>params</code> hash contains information about each request.<span class="intersentencespace"></span> In the case of a URL like /users/1, the value of <code>params[:id]</code> is the <code>id</code> of the corresponding user (<code>1</code>&nbsp;in this example).<span class="intersentencespace"></span> In the case of posting to the signup form, <code>params</code> instead contains a hash of hashes, a construction we first saw in <a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-hashes_and_symbols" class="hyperref">Section&nbsp;<span class="ref">4.3.3</span></a>, which introduced the strategically named <code>params</code> variable in a console session.<span class="intersentencespace"></span> The debug information above shows that submitting the form results in a <code>user</code> hash with attributes corresponding to the submitted values, where the keys come from the <code>name</code> attributes of the <code>input</code> tags seen in <a href="https://www.railstutorial.org/book/sign_up#code-signup_form_html" class="hyperref">Listing&nbsp;<span class="ref">7.17</span></a>.<span class="intersentencespace"></span> For example, the value of</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;input</span> <span class="na">id=</span><span class="s">"user_email"</span> <span class="na">name=</span><span class="s">"user[email]"</span> <span class="na">type=</span><span class="s">"email"</span> <span class="nt">/&gt;</span>
</pre></div></div>
<p>with name <code>"user[email]"</code> is precisely the <code>email</code> attribute of the <code>user</code> hash.</p>
<p>Although the hash keys appear as strings in the debug output, we can access them in the Users controller as symbols, so that <code>params[:user]</code> is the hash of user attributesin fact, exactly the attributes needed as an argument to <code>User.new</code>, as first seen in <a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-a_user_class" class="hyperref">Section&nbsp;<span class="ref">4.4.5</span></a> and appearing in <a href="https://www.railstutorial.org/book/sign_up#code-first_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.18</span></a>.<span class="intersentencespace"></span> This means that the line</p>
<div class="code"><div class="highlight"><pre><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="p">)</span>
</pre></div></div>
<p>is mostly equivalent to</p>
<div class="code"><div class="highlight"><pre><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">"Foo Bar"</span><span class="p">,</span> <span class="ss">email</span><span class="p">:</span> <span class="s2">"foo@invalid"</span><span class="p">,</span>
                 <span class="ss">password</span><span class="p">:</span> <span class="s2">"foo"</span><span class="p">,</span> <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"bar"</span><span class="p">)</span>
</pre></div></div>
<p>In previous versions of Rails, using</p>
<div class="code"><div class="highlight"><pre><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="p">)</span>
</pre></div></div>
<p>actually worked, but it was insecure by default and required a 
careful and error-prone procedure to prevent malicious users from 
potentially modifying the application database.<span class="intersentencespace"></span> In Rails version later than 4.0, this code raises an error (as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure" class="hyperref">Figure&nbsp;<span class="ref">7.15</span></a> and <a href="https://www.railstutorial.org/book/sign_up#fig-signup_failure_rails_debug" class="hyperref">Figure&nbsp;<span class="ref">7.16</span></a> above), which means it is secure by default.</p>
</div>
<div id="_sec-strong_parameters" data-tralics-id="uid889" class="subsection" data-number="7.3.2"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-strong_parameters" class="heading hyperref"><span class="number">7.3.2 </span>Strong parameters</a></h3>
<p>We mentioned briefly in <a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-a_user_class" class="hyperref">Section&nbsp;<span class="ref">4.4.5</span></a> the idea of <em>mass assignment</em>, which involves initializing a Ruby variable using a hash of values, as in</p>
<div class="code"><div class="highlight"><pre><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:user</span><span class="o">]</span><span class="p">)</span>    <span class="c1"># Not the final implementation!</span>
</pre></div></div>
<p>The comment included in <a href="https://www.railstutorial.org/book/sign_up#code-first_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.18</span></a> and reproduced above indicates that this is not the final implementation.<span class="intersentencespace"></span> The reason is that initializing the entire <code>params</code> hash is <em>extremely</em> dangerousit arranges to pass to <code>User.new</code> <em>all</em> data submitted by a user.<span class="intersentencespace"></span> In particular, suppose that, in addition to the current attributes, the User model included an <code>admin</code> attribute used to identify administrative users of the site.<span class="intersentencespace"></span> (We will implement just such an attribute in <a href="https://www.railstutorial.org/book/updating_and_deleting_users#sec-administrative_users" class="hyperref">Section&nbsp;<span class="ref">10.4.1</span></a>.)<span class="intersentencespace"></span> The way to set such an attribute to <code>true</code> is to pass the value <code>admin='1'</code> as part of <code>params[:user]</code>, a task that is easy to accomplish using a command-line HTTP client such as <code class="tt">curl</code>.<span class="intersentencespace"></span> The result would be that, by passing in the entire <code>params</code> hash to <code>User.new</code>, we would allow any user of the site to gain administrative access by including <code>admin='1'</code> in the web request.</p>
<p>Previous versions of Rails used a method called <code>attr_accessible</code> in the <em>model</em>
 layer to solve this problem, and you may still see that method in 
legacy Rails applications, but as of Rails&nbsp;4.0 the preferred 
technique is to use so-called <em>strong parameters</em> in the controller layer.<span class="intersentencespace"></span> This allows us to specify which parameters are <em>required</em> and which ones are <em>permitted</em>.<span class="intersentencespace"></span> In addition, passing in a raw <code>params</code>
 hash as above will cause an error to be raised, so that Rails 
applications are now immune to mass assignment vulnerabilities by 
default.</p>
<p>In the present instance, we want to require the <code>params</code> hash to have a <code>:user</code> attribute, and we want to permit the name, email, password, and password confirmation attributes (but no others).<span class="intersentencespace"></span> We can accomplish this as follows:</p>
<div class="code"><div class="highlight"><pre><span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">:password_confirmation</span><span class="p">)</span>
</pre></div></div>
<p>This code returns a version of the <code>params</code> hash with only the permitted attributes (while raising an error if the <code>:user</code> attribute is missing).</p>
<p>To facilitate the use of these parameters, its conventional to introduce an auxiliary method called <code>user_params</code> (which returns an appropriate initialization hash) and use it in place of <code>params[:user]</code>:</p>
<div class="code"><div class="highlight"><pre><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">user_params</span><span class="p">)</span>
</pre></div></div>
<p>Since <code>user_params</code> will only be used internally by the Users controller and need not be exposed to external users via the web, well make it <em>private</em> using Rubys <code>private</code> keyword, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-create_action_strong_parameters" class="hyperref">Listing&nbsp;<span class="ref">7.19</span></a>.<span class="intersentencespace"></span> (Well discuss <code>private</code> in more detail in <a href="https://www.railstutorial.org/book/advanced_login#sec-remember_me" class="hyperref">Section&nbsp;<span class="ref">9.1</span></a>.)</p>
<div class="codelisting" id="_code-create_action_strong_parameters" data-tralics-id="uid890" data-number="7.19"><div class="heading"><span class="number">Listing 7.19:</span> 

<span class="description">Using strong parameters in the <code>create</code> action.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="k">def</span> <span class="nf">create</span>
<span class="hll">    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">user_params</span><span class="p">)</span>
</span>    <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">save</span>
      <span class="c1"># Handle a successful save.</span>
    <span class="k">else</span>
      <span class="n">render</span> <span class="s1">'new'</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>

    <span class="k">def</span> <span class="nf">user_params</span>
<span class="hll">      <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span>
</span><span class="hll">                                   <span class="ss">:password_confirmation</span><span class="p">)</span>
</span>    <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>By the way, the extra level of indentation on the <code>user_params</code> method is designed to make it visually apparent which methods are defined after <code>private</code>.<span class="intersentencespace"></span>
 (Experience shows that this is a wise practice; in classes with a large
 number of methods, it is easy to define a private method accidentally, 
which leads to considerable confusion when it isnt available to call on
 the corresponding object.)</p>
<p>At this point, the signup form is working, at least in the sense that it no longer produces an error upon submission.<span class="intersentencespace"></span> On the other hand, as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-invalid_submission_no_feedback" class="hyperref">Figure&nbsp;<span class="ref">7.17</span></a>,
 it doesnt display any feedback on invalid submissions (apart from the 
development-only debug area), which is potentially confusing.<span class="intersentencespace"></span> It also doesnt actually create a new user.<span class="intersentencespace"></span> Well fix the first issue in <a href="https://www.railstutorial.org/book/sign_up#sec-signup_error_messages" class="hyperref">Section&nbsp;<span class="ref">7.3.3</span></a> and the second in <a href="https://www.railstutorial.org/book/sign_up#sec-successful_signups" class="hyperref">Section&nbsp;<span class="ref">7.4</span></a>.</p>
<div class="center figure" id="_fig-invalid_submission_no_feedback" data-tralics-id="uid891" data-number="7.17">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/invalid_submission_no_feedback_4th_ed.png" alt="images/figures/invalid_submission_no_feedback_4th_ed"></div><div class="caption"><span class="header">Figure 7.17: </span><span class="description">The signup form submitted with invalid information.
</span></div></div>
<div id="_sec-exercises_a_working_form" data-tralics-id="uid892" class="subsubsection" data-number="7.3.2.1"><h4><a href="#sec-exercises_a_working_form" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>By hitting the URL /signup?admin=1, confirm that the <code>admin</code> attribute appears in the <code>params</code> debug information. <span class="exercise" id="ex-b3c548"></span>
</li></ol>
</div></div>
<div id="_sec-signup_error_messages" data-tralics-id="uid894" class="subsection" data-number="7.3.3"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-signup_error_messages" class="heading hyperref"><span class="number">7.3.3 </span>Signup error messages</a></h3>
<p>As a final step in handling failed user creation, well add helpful 
error messages to indicate the problems that prevented successful 
signup.<span class="intersentencespace"></span> Conveniently, Rails automatically provides such messages based on the User model validations.<span class="intersentencespace"></span> For example, consider trying to save a user with an invalid email address and with a password thats too short:</p>
<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="nb">name</span><span class="p">:</span> <span class="s2">"Foo Bar"</span><span class="p">,</span> <span class="ss">email</span><span class="p">:</span> <span class="s2">"foo@invalid"</span><span class="p">,</span>
<span class="gp">?&gt; </span>                <span class="ss">password</span><span class="p">:</span> <span class="s2">"dude"</span><span class="p">,</span> <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"dude"</span><span class="p">)</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">save</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">full_messages</span>
<span class="go">=&gt; ["Email is invalid", "Password is too short (minimum is 6 characters)"]</span>
</pre></div></div>
<p>Here the <code>errors.full_messages</code> object (which we saw briefly before in <a href="https://www.railstutorial.org/book/modeling_users#sec-presence_validation" class="hyperref">Section&nbsp;<span class="ref">6.2.2</span></a>) contains an array of error messages.</p>
<p>As in the console session above, the failed save in <a href="https://www.railstutorial.org/book/sign_up#code-first_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.18</span></a> generates a list of error messages associated with the <code>@user</code> object.<span class="intersentencespace"></span> To display the messages in the browser, well render an error-messages partial on the user <code>new</code> page while adding the CSS class <code>form-control</code> (which has special meaning to Bootstrap) to each entry field, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-f_error_messages" class="hyperref">Listing&nbsp;<span class="ref">7.20</span></a>.<span class="intersentencespace"></span> Its worth noting that this error-messages partial is only a first attempt; the final version appears in <a href="https://www.railstutorial.org/book/user_microposts#sec-creating_microposts" class="hyperref">Section&nbsp;<span class="ref">13.3.2</span></a>.</p>
<div class="codelisting" id="_code-f_error_messages" data-tralics-id="uid895" data-number="7.20"><div class="heading"><span class="number">Listing 7.20:</span> 

<span class="description">Code to display error messages on the signup form.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/users/new.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">'Sign up'</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Sign up<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6 col-md-offset-3"</span><span class="nt">&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">form_for</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'shared/error_messages'</span> <span class="cp">%&gt;</span>
</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>
</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">email_field</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>
</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>
</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="s2">"Confirmation"</span> <span class="cp">%&gt;</span>
<span class="hll">      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>
</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="s2">"Create my account"</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"btn btn-primary"</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></div></div><p>Notice here that we <code>render</code> a partial called <code>'shared/error_messages'</code>; this reflects the common Rails convention of using a dedicated <code>shared/</code> directory for partials expected to be used in views across multiple controllers.<span class="intersentencespace"></span> (Well see this expectation fulfilled in <a href="https://www.railstutorial.org/book/updating_and_deleting_users#sec-edit_form" class="hyperref">Section&nbsp;<span class="ref">10.1.1</span></a>.)<span class="intersentencespace"></span> This means that we have to create a new <code>app/views/shared</code> directory using <code>mkdir</code> (<a href="https://www.railstutorial.org/book/beginning#table-unix_commands" class="hyperref">Table&nbsp;<span class="ref">1.1</span></a>):</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> mkdir app/views/shared
</pre></div></div>
<p>We then need to create the <code>_error_messages.html.erb</code> partial file using our text editor as usual.<span class="intersentencespace"></span> The contents of the partial appear in <a href="https://www.railstutorial.org/book/sign_up#code-errors_partial" class="hyperref">Listing&nbsp;<span class="ref">7.21</span></a>.</p>
<div class="codelisting" id="_code-errors_partial" data-tralics-id="uid896" data-number="7.21"><div class="heading"><span class="number">Listing 7.21:</span> 

<span class="description">A partial for displaying form submission error messages.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/shared/_error_messages.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"error_explanation"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-danger"</span><span class="nt">&gt;</span>
      The form contains <span class="cp">&lt;%=</span> <span class="n">pluralize</span><span class="p">(</span><span class="vi">@user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="s2">"error"</span><span class="p">)</span> <span class="cp">%&gt;</span>.
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;ul&gt;</span>
    <span class="cp">&lt;%</span> <span class="vi">@user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">full_messages</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">msg</span><span class="o">|</span> <span class="cp">%&gt;</span>
      <span class="nt">&lt;li&gt;</span><span class="cp">&lt;%=</span> <span class="n">msg</span> <span class="cp">%&gt;</span><span class="nt">&lt;/li&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;/ul&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</pre></div></div></div><p>This partial introduces several new Rails and Ruby constructs, including two methods for Rails error objects.<span class="intersentencespace"></span> The first method is <code>count</code>, which simply returns the number of errors:</p>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">count</span>
<span class="go">=&gt; 2</span>
</pre></div></div>
<p>The other new method is <code>any?</code>, which (together with <code>empty?</code>) is one of a pair of complementary methods:</p>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">empty?</span>
<span class="go">=&gt; false</span>
<span class="gp">&gt;&gt; </span><span class="n">user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">any?</span>
<span class="go">=&gt; true</span>
</pre></div></div>
<p>We see here that the <code>empty?</code> method, which we first saw in <a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-objects_and_message_passing" class="hyperref">Section&nbsp;<span class="ref">4.2.3</span></a> in the context of strings, also works on Rails error objects, returning <code>true</code> for an empty object and <code>false</code> otherwise.<span class="intersentencespace"></span> The <code>any?</code> method is just the opposite of <code>empty?</code>, returning <code>true</code> if there are any elements present and <code>false</code> otherwise.<span class="intersentencespace"></span> (By the way, all of these methods<code>count</code>, <code>empty?</code>, and <code>any?</code>work on Ruby arrays as well.<span class="intersentencespace"></span> Well put this fact to good use starting in <a href="https://www.railstutorial.org/book/user_microposts#sec-showing_microposts" class="hyperref">Section&nbsp;<span class="ref">13.2</span></a>.)</p>
<p>The other new idea is the <code>pluralize</code> text helper, which is available in the console via the <code>helper</code> object:</p>
<div class="code"><div class="highlight"><pre><span class="gp">&gt;&gt; </span><span class="n">helper</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">"error"</span><span class="p">)</span>
<span class="go">=&gt; "1 error"</span>
<span class="gp">&gt;&gt; </span><span class="n">helper</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">"error"</span><span class="p">)</span>
<span class="go">=&gt; "5 errors"</span>
</pre></div></div>
<p>We see here that <code>pluralize</code> takes an integer argument and then returns the number with a properly pluralized version of its second argument.<span class="intersentencespace"></span> Underlying this method is a powerful <em>inflector</em> that knows how to pluralize a large number of words, including many with irregular plurals:</p>
<div class="code"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt; </span><span class="n">helper</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">"woman"</span><span class="p">)</span>
<span class="go">=&gt; "2 women"</span>
<span class="gp">&gt;&gt; </span><span class="n">helper</span><span class="o">.</span><span class="n">pluralize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">"erratum"</span><span class="p">)</span>
<span class="go">=&gt; "3 errata"</span>
</pre></div></div>
<p>As a result of its use of <code>pluralize</code>, the code</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%=</span> <span class="n">pluralize</span><span class="p">(</span><span class="vi">@user</span><span class="o">.</span><span class="n">errors</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="s2">"error"</span><span class="p">)</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>returns <code>"0 errors"</code>, <code>"1 error"</code>, <code>"2 errors"</code>, and so on, depending on how many errors there are, thereby avoiding ungrammatical phrases such as <code>"1 errors"</code> (a distressingly common mistake in apps and on the Web).</p>
<p>Note that <a href="https://www.railstutorial.org/book/sign_up#code-errors_partial" class="hyperref">Listing&nbsp;<span class="ref">7.21</span></a> includes the CSS&nbsp;id <code>error_explanation</code> for use in styling the error messages.<span class="intersentencespace"></span> (Recall from <a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-custom_css" class="hyperref">Section&nbsp;<span class="ref">5.1.2</span></a> that CSS uses the pound sign <code>#</code> to style ids.)<span class="intersentencespace"></span> In addition, after an invalid submission Rails automatically wraps the fields with errors in <code>div</code>s with the CSS class <code>field_with_errors</code>.<span class="intersentencespace"></span> These labels then allow us to style the error messages with the SCSS shown in <a href="https://www.railstutorial.org/book/sign_up#code-error_messages_css" class="hyperref">Listing&nbsp;<span class="ref">7.22</span></a>, which makes use of Sasss <code>@extend</code> function to include the functionality of the Bootstrap class <code>has-error</code>.</p>
<div class="codelisting" id="_code-error_messages_css" data-tralics-id="uid897" data-number="7.22"><div class="heading"><span class="number">Listing 7.22:</span> 

<span class="description">CSS for styling error messages.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/assets/stylesheets/custom.scss</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="o">/*</span> <span class="nt">forms</span> <span class="o">*/</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nc">.</span>
<span class="nn">#error_explanation</span> <span class="p">{</span>
  <span class="na">color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
  <span class="nt">ul</span> <span class="p">{</span>
    <span class="na">color</span><span class="o">:</span> <span class="nb">red</span><span class="p">;</span>
    <span class="na">margin</span><span class="o">:</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">30</span><span class="kt">px</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="nc">.field_with_errors</span> <span class="p">{</span>
  <span class="k">@extend</span> <span class="nc">.has-error</span><span class="o">;</span>
  <span class="nc">.form-control</span> <span class="p">{</span>
    <span class="na">color</span><span class="o">:</span> <span class="nv">$state-danger-text</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div></div></div><p>With the code in <a href="https://www.railstutorial.org/book/sign_up#code-f_error_messages" class="hyperref">Listing&nbsp;<span class="ref">7.20</span></a> and <a href="https://www.railstutorial.org/book/sign_up#code-errors_partial" class="hyperref">Listing&nbsp;<span class="ref">7.21</span></a> and the SCSS from <a href="https://www.railstutorial.org/book/sign_up#code-error_messages_css" class="hyperref">Listing&nbsp;<span class="ref">7.22</span></a>, helpful error messages now appear when submitting invalid signup information, as seen in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_error_messages" class="hyperref">Figure&nbsp;<span class="ref">7.18</span></a>.<span class="intersentencespace"></span>
 Because the messages are generated by the model validations, they will 
automatically change if you ever change your mind about, say, the format
 of email addresses, or the minimum length of passwords.<span class="intersentencespace"></span> (<em>Note</em>: Because both the presence validation and the <code>has_secure_password</code> validation catch the case of <em>empty</em> (<code>nil</code>) passwords, the signup form currently produces duplicate error messages when the user submits empty passwords.<span class="intersentencespace"></span>
 We could manipulate the error messages directly to eliminate 
duplicates, but luckily this issue will be fixed automatically by the 
addition of <code>allow_nil: true</code> in <a href="https://www.railstutorial.org/book/updating_and_deleting_users#sec-successful_edits" class="hyperref">Section&nbsp;<span class="ref">10.1.4</span></a>.)</p>
<div class="center figure" id="_fig-signup_error_messages" data-tralics-id="uid898" data-number="7.18">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_error_messages_3rd_edition.png" alt="images/figures/signup_error_messages_3rd_edition"></div><div class="caption"><span class="header">Figure 7.18: </span><span class="description">Failed signup with error messages.
</span></div></div>
<div id="_sec-exercises_signup_error_messages" data-tralics-id="uid899" class="subsubsection" data-number="7.3.3.1"><h4><a href="#sec-exercises_signup_error_messages" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Confirm by changing the minimum length of passwords to 5 that the error message updates automatically as well. <span class="exercise" id="ex-6e3d33"></span>
</li>
<li>How does the URL on the unsubmitted signup form (<a href="https://www.railstutorial.org/book/sign_up#fig-signup_form" class="hyperref">Figure&nbsp;<span class="ref">7.12</span></a>) compare to the URL for a submitted signup form (<a href="https://www.railstutorial.org/book/sign_up#fig-signup_error_messages" class="hyperref">Figure&nbsp;<span class="ref">7.18</span></a>)?<span class="intersentencespace"></span> Why dont they match? <span class="exercise" id="ex-ad9fd0"></span>
</li></ol>
</div></div>
<div id="_sec-a_test_for_invalid_submission" data-tralics-id="uid902" class="subsection" data-number="7.3.4"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-a_test_for_invalid_submission" class="heading hyperref"><span class="number">7.3.4 </span>A test for invalid submission</a></h3>
<p>In the days before powerful web frameworks with automated testing capabilities, developers had to test forms by hand.<span class="intersentencespace"></span>
 For example, to test a signup page manually, we would have to visit the
 page in a browser and then submit alternately invalid and valid data, 
verifying in each case that the applications behavior was correct.<span class="intersentencespace"></span> Moreover, we would have to remember to repeat the process any time the application changed.<span class="intersentencespace"></span> This process was painful and error-prone.</p>
<p>Happily, with Rails we can write tests to automate the testing of forms.<span class="intersentencespace"></span> In this section, well write one such test to verify the correct behavior upon invalid form submission; in <a href="https://www.railstutorial.org/book/sign_up#sec-a_test_for_valid_submission" class="hyperref">Section&nbsp;<span class="ref">7.4.4</span></a>, well write a corresponding test for valid submission.</p>
<p>To get started, we first generate an integration test file for signing up users, which well call <code>users_signup</code> (adopting the controller convention of a plural resource name):</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> rails generate integration_test users_signup
<span class="go">      invoke  test_unit</span>
<span class="go">      create    test/integration/users_signup_test.rb</span>
</pre></div></div>
<p>(Well use this same file in <a href="https://www.railstutorial.org/book/sign_up#sec-a_test_for_valid_submission" class="hyperref">Section&nbsp;<span class="ref">7.4.4</span></a> to test a valid signup.)</p>
<p>The main purpose of our test is to verify that clicking the signup button results in <em>not</em> creating a new user when the submitted information is invalid.<span class="intersentencespace"></span> (Writing a test for the error messages is left as an exercise (<a href="https://www.railstutorial.org/book/sign_up#sec-exercises_a_test_for_invalid_submission" class="hyperref">Section&nbsp;<span class="ref">7.3.4.1</span></a>).)<span class="intersentencespace"></span> The way to do this is to check the <em>count</em> of users, and under the hood our tests will use the <code>count</code> method available on every Active Record class, including <code>User</code>:</p>
<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="no">User</span><span class="o">.</span><span class="n">count</span>
<span class="go">=&gt; 1</span>
</pre></div></div>
<p>(Here <code>User.count</code> is <code>1</code> because of the user created in <a href="https://www.railstutorial.org/book/modeling_users#sec-creating_and_authenticating_a_user" class="hyperref">Section&nbsp;<span class="ref">6.3.4</span></a>, though it may differ if youve added or deleted any users in the interim.)<span class="intersentencespace"></span> As in <a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-layout_link_tests" class="hyperref">Section&nbsp;<span class="ref">5.3.4</span></a>, well use <code>assert_select</code> to test HTML elements of the relevant pages, taking care to check only elements unlikely to change in the future.</p>
<p>Well start by visiting the signup path using <code>get</code>:</p>
<div class="code"><div class="highlight"><pre><span class="n">get</span> <span class="n">signup_path</span>
</pre></div></div>
<p>In order to test the form submission, we need to issue a <code class="tt">POST</code> request to the <code>users_path</code> (<a href="https://www.railstutorial.org/book/sign_up#table-RESTful_users" class="hyperref">Table&nbsp;<span class="ref">7.1</span></a>), which we can do with the <code>post</code> function:</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_no_difference</span> <span class="s1">'User.count'</span> <span class="k">do</span>
  <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="p">{</span> <span class="ss">user</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span>  <span class="s2">""</span><span class="p">,</span>
                                     <span class="ss">email</span><span class="p">:</span> <span class="s2">"user@invalid"</span><span class="p">,</span>
                                     <span class="ss">password</span><span class="p">:</span>              <span class="s2">"foo"</span><span class="p">,</span>
                                     <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"bar"</span> <span class="p">}</span> <span class="p">}</span>
<span class="k">end</span>
</pre></div></div>
<p>Here weve included the <code>params[:user]</code> hash expected by <code>User.new</code> in the <code>create</code> action (<a href="https://www.railstutorial.org/book/sign_up#code-signup_flash" class="hyperref">Listing&nbsp;<span class="ref">7.29</span></a>).<span class="intersentencespace"></span> (In versions of Rails before 5, <code>params</code> was implicit, and only the <code>user</code> hash would be passed.<span class="intersentencespace"></span> This practice was deprecated in Rails&nbsp;5.0, and now the recommended method is to include the full <code>params</code> hash explicitly.)</p>
<p>By wrapping the <code>post</code> in the <code>assert_no_difference</code> method with the string argument <code>'User.count'</code>, we arrange for a comparison between <code>User.count</code> before and after the contents inside the <code>assert_no_difference</code> block.<span class="intersentencespace"></span> This is equivalent to recording the user count, posting the data, and verifying that the count is the same:</p>
<div class="code"><div class="highlight"><pre><span class="n">before_count</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">count</span>
<span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
<span class="n">after_count</span>  <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">count</span>
<span class="n">assert_equal</span> <span class="n">before_count</span><span class="p">,</span> <span class="n">after_count</span>
</pre></div></div>
<p>Although the two are equivalent, using <code>assert_no_difference</code> is cleaner and is more idiomatically correct Ruby.</p>
<p>Its worth noting that the <code>get</code> and <code>post</code> steps above are technically unrelated, and its actually not necessary to get the signup path before posting to the users path.<span class="intersentencespace"></span>
 I prefer to include both steps, though, both for conceptual clarity and
 to double-check that the signup form renders without error.</p>
<p>Putting the above ideas together leads to the test in <a href="https://www.railstutorial.org/book/sign_up#code-a_test_for_invalid_submission" class="hyperref">Listing&nbsp;<span class="ref">7.23</span></a>.<span class="intersentencespace"></span> Weve also included a call to <code>assert_template</code> to check that a failed submission re-renders the <code>new</code> action.<span class="intersentencespace"></span> Adding lines to check for the appearance of error messages is left as an exercise (<a href="https://www.railstutorial.org/book/sign_up#sec-exercises_a_test_for_invalid_submission" class="hyperref">Section&nbsp;<span class="ref">7.3.4.1</span></a>).</p>
<div class="codelisting" id="_code-a_test_for_invalid_submission" data-tralics-id="uid903" data-number="7.23"><div class="heading"><span class="number">Listing 7.23:</span> 

<span class="description">A test for an invalid signup.<span class="intersentencespace"></span> <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <code class="filepath">test/integration/users_signup_test.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">UsersSignupTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"invalid signup information"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">signup_path</span>
    <span class="n">assert_no_difference</span> <span class="s1">'User.count'</span> <span class="k">do</span>
      <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="p">{</span> <span class="ss">user</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span>  <span class="s2">""</span><span class="p">,</span>
                                         <span class="ss">email</span><span class="p">:</span> <span class="s2">"user@invalid"</span><span class="p">,</span>
                                         <span class="ss">password</span><span class="p">:</span>              <span class="s2">"foo"</span><span class="p">,</span>
                                         <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"bar"</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">end</span>
    <span class="n">assert_template</span> <span class="s1">'users/new'</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Because we wrote the application code before the integration test, the test suite should be <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>:</p>
<div class="codelisting" id="_uid904" data-tralics-id="uid904" data-number="7.24"><div class="heading"><span class="number">Listing 7.24:</span> <span class="description"><span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span></span>
</div>

<div class="code"><div class="highlight"><pre>$ rails test
</pre></div></div></div>
<div id="_sec-exercises_a_test_for_invalid_submission" data-tralics-id="uid905" class="subsubsection" data-number="7.3.4.1"><h4><a href="#sec-exercises_a_test_for_invalid_submission" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Write a test for the error messages implemented in <a href="https://www.railstutorial.org/book/sign_up#code-f_error_messages" class="hyperref">Listing&nbsp;<span class="ref">7.20</span></a>.<span class="intersentencespace"></span> How detailed you want to make your tests is up to you; a suggested template appears in <a href="https://www.railstutorial.org/book/sign_up#code-error_messages_test" class="hyperref">Listing&nbsp;<span class="ref">7.25</span></a>. <span class="exercise" id="ex-adc77f"></span>
</li>
<li>The URLs for an unsubmitted signup form and for a submitted signup form are /signup and /users, respectively, which dont match.<span class="intersentencespace"></span> This is due to our use of a custom named route in the former case (added in <a href="https://www.railstutorial.org/book/filling_in_the_layout#code-signup_route" class="hyperref">Listing&nbsp;<span class="ref">5.43</span></a>) and a default RESTful route in the latter case (<a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>).<span class="intersentencespace"></span> Resolve this discrepancy by adding the code shown in <a href="https://www.railstutorial.org/book/sign_up#code-post_signup" class="hyperref">Listing&nbsp;<span class="ref">7.26</span></a> and <a href="https://www.railstutorial.org/book/sign_up#code-post_signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.27</span></a>.<span class="intersentencespace"></span> Submit the new form to confirm that both cases now use the same /signup URL.<span class="intersentencespace"></span> Are the tests still <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>?<span class="intersentencespace"></span> Why? <span class="exercise" id="ex-4ee5ec"></span>
</li>
<li>Update the <code>post</code> in <a href="https://www.railstutorial.org/book/sign_up#code-error_messages_test" class="hyperref">Listing&nbsp;<span class="ref">7.25</span></a> to use the new URL from the previous exercise.<span class="intersentencespace"></span> Confirm that the tests are still <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>. <span class="exercise" id="ex-0b38a0"></span>
</li>
<li>Confirm by reverting <a href="https://www.railstutorial.org/book/sign_up#code-post_signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.27</span></a> to its previous form (<a href="https://www.railstutorial.org/book/sign_up#code-f_error_messages" class="hyperref">Listing&nbsp;<span class="ref">7.20</span></a>) that the tests are still <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span>.<span class="intersentencespace"></span> This is a problem, because the URL being posted to isnt right.<span class="intersentencespace"></span> Add an <code>assert_select</code> to the test in <a href="https://www.railstutorial.org/book/sign_up#code-error_messages_test" class="hyperref">Listing&nbsp;<span class="ref">7.25</span></a> to catch this bug and get to <span style="color: red"><span class="sc"></span><span class="sc"><strong>red</strong></span><span class="sc"></span></span>, then change the form back to <a href="https://www.railstutorial.org/book/sign_up#code-post_signup_form" class="hyperref">Listing&nbsp;<span class="ref">7.27</span></a> to get the tests <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span> again.<span class="intersentencespace"></span> <em>Hint</em>: Test for the presence of <code>'form[action="/signup"]'</code> before posting to the form in the test. <span class="exercise" id="ex-678d64"></span>
</li></ol>
<div class="codelisting" id="_code-error_messages_test" data-tralics-id="uid910" data-number="7.25"><div class="heading"><span class="number">Listing 7.25:</span> 

<span class="description">A template for tests of the error messages.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">test/integration/users_signup_test.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">UsersSignupTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>

  <span class="nb">test</span> <span class="s2">"invalid signup information"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">signup_path</span>
    <span class="n">assert_no_difference</span> <span class="s1">'User.count'</span> <span class="k">do</span>
      <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="p">{</span> <span class="ss">user</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span>  <span class="s2">""</span><span class="p">,</span>
                                         <span class="ss">email</span><span class="p">:</span> <span class="s2">"user@invalid"</span><span class="p">,</span>
                                         <span class="ss">password</span><span class="p">:</span>              <span class="s2">"foo"</span><span class="p">,</span>
                                         <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"bar"</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">end</span>
    <span class="n">assert_template</span> <span class="s1">'users/new'</span>
<span class="hll">    <span class="n">assert_select</span> <span class="s1">'div#&lt;CSS id for error explanation&gt;'</span>
</span><span class="hll">    <span class="n">assert_select</span> <span class="s1">'div.&lt;CSS class for field with error&gt;'</span>
</span>  <span class="k">end</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="_code-post_signup" data-tralics-id="uid911" data-number="7.26"><div class="heading"><span class="number">Listing 7.26:</span> 

<span class="description">Adding a signup route responding to <code class="tt">POST</code> requests.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">config/routes.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
  <span class="n">root</span> <span class="s1">'static_pages#home'</span>
  <span class="n">get</span>  <span class="s1">'/help'</span><span class="p">,</span>    <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#help'</span>
  <span class="n">get</span>  <span class="s1">'/about'</span><span class="p">,</span>   <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#about'</span>
  <span class="n">get</span>  <span class="s1">'/contact'</span><span class="p">,</span> <span class="ss">to</span><span class="p">:</span> <span class="s1">'static_pages#contact'</span>
  <span class="n">get</span>  <span class="s1">'/signup'</span><span class="p">,</span>  <span class="ss">to</span><span class="p">:</span> <span class="s1">'users#new'</span>
<span class="hll">  <span class="n">post</span> <span class="s1">'/signup'</span><span class="p">,</span>  <span class="ss">to</span><span class="p">:</span> <span class="s1">'users#create'</span>
</span>  <span class="n">resources</span> <span class="ss">:users</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="_code-post_signup_form" data-tralics-id="uid912" data-number="7.27"><div class="heading"><span class="number">Listing 7.27:</span> 

<span class="description">Posting to the /signup URL. <span class="break"></span> <code class="filepath">app/views/users/new.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">provide</span><span class="p">(</span><span class="ss">:title</span><span class="p">,</span> <span class="s1">'Sign up'</span><span class="p">)</span> <span class="cp">%&gt;</span>
<span class="nt">&lt;h1&gt;</span>Sign up<span class="nt">&lt;/h1&gt;</span>

<span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"row"</span><span class="nt">&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"col-md-6 col-md-offset-3"</span><span class="nt">&gt;</span>
<span class="hll">    <span class="cp">&lt;%=</span> <span class="n">form_for</span><span class="p">(</span><span class="vi">@user</span><span class="p">,</span> <span class="ss">url</span><span class="p">:</span> <span class="n">signup_path</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="cp">%&gt;</span>
</span>      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'shared/error_messages'</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:name</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">text_field</span> <span class="ss">:name</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:email</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">email_field</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">label</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="s2">"Confirmation"</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">password_field</span> <span class="ss">:password_confirmation</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s1">'form-control'</span> <span class="cp">%&gt;</span>

      <span class="cp">&lt;%=</span> <span class="n">f</span><span class="o">.</span><span class="n">submit</span> <span class="s2">"Create my account"</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"btn btn-primary"</span> <span class="cp">%&gt;</span>
    <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div></div></div></div></div></div><div id="_sec-successful_signups" data-tralics-id="cid41" class="section" data-number="7.4"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-successful_signups" class="heading hyperref"><span class="number">7.4 </span>Successful signups</a></h2>
<p>Having handled invalid form submissions, now its time to complete 
the signup form by actually saving a new user (if valid) to the 
database.<span class="intersentencespace"></span> First, we try to save 
the user; if the save succeeds, the users information gets written to 
the database automatically, and we then <em>redirect</em> the browser to show the users profile (together with a friendly greeting), as mocked up in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_success_mockup" class="hyperref">Figure&nbsp;<span class="ref">7.19</span></a>.<span class="intersentencespace"></span> If it fails, we simply fall back on the behavior developed in <a href="https://www.railstutorial.org/book/sign_up#sec-unsuccessful_signups" class="hyperref">Section&nbsp;<span class="ref">7.3</span></a>.</p>
<div class="center figure" id="_fig-signup_success_mockup" data-tralics-id="uid913" data-number="7.19">
<div class="graphics image box"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_success_mockup_bootstrap.png" alt="images/figures/signup_success_mockup_bootstrap"></div><div class="caption"><span class="header">Figure 7.19: </span><span class="description">A mockup of successful signup.
</span></div></div>
<div id="_sec-the_finished_signup_form" data-tralics-id="uid914" class="subsection" data-number="7.4.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-the_finished_signup_form" class="heading hyperref"><span class="number">7.4.1 </span>The finished signup form</a></h3>
<p>To complete a working signup form, we need to fill in the commented-out section in <a href="https://www.railstutorial.org/book/sign_up#code-create_action_strong_parameters" class="hyperref">Listing&nbsp;<span class="ref">7.19</span></a> with the appropriate behavior.<span class="intersentencespace"></span> Currently, the form simply freezes on valid submission, as indicated by the color change in the submission button (<a href="https://www.railstutorial.org/book/sign_up#fig-valid_submission_error" class="hyperref">Figure&nbsp;<span class="ref">7.20</span></a>), although this behavior may be system-dependent.<span class="intersentencespace"></span>
 This is because the default behavior for a Rails action is to render 
the corresponding view, and there isnt a view template corresponding to
 the <code>create</code> action (<a href="https://www.railstutorial.org/book/sign_up#fig-no_create_template_error" class="hyperref">Figure&nbsp;<span class="ref">7.21</span></a>).</p>
<div class="center figure" id="_fig-valid_submission_error" data-tralics-id="uid915" data-number="7.20">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/valid_submission_error_4th_ed.png" alt="images/figures/valid_submission_error_4th_ed"></div><div class="caption"><span class="header">Figure 7.20: </span><span class="description">The frozen page on valid signup submission.
</span></div></div>
<div class="center figure" id="_fig-no_create_template_error" data-tralics-id="uid916" data-number="7.21">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/no_create_template_error.png" alt="images/figures/no_create_template_error"></div><div class="caption"><span class="header">Figure 7.21: </span><span class="description">The <code>create</code> template error in the server log.
</span></div></div>
<p>Although its possible to render a template for the <code>create</code> action, the usual practice is to <em>redirect</em> to a different page instead when the creation is successful.<span class="intersentencespace"></span>
 In particular, well follow the common convention of redirecting to the
 newly created users profile, although the root path would also work.<span class="intersentencespace"></span> The application code, which introduces the <code>redirect_to</code> method, appears in <a href="https://www.railstutorial.org/book/sign_up#code-user_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.28</span></a>.</p>
<div class="codelisting" id="_code-user_create_action" data-tralics-id="uid917" data-number="7.28"><div class="heading"><span class="number">Listing 7.28:</span> 

<span class="description">The user <code>create</code> action with a save and a redirect.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="k">def</span> <span class="nf">create</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">user_params</span><span class="p">)</span>
    <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">save</span>
<span class="hll">      <span class="n">redirect_to</span> <span class="vi">@user</span>
</span>    <span class="k">else</span>
      <span class="n">render</span> <span class="s1">'new'</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>

    <span class="k">def</span> <span class="nf">user_params</span>
      <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span>
                                   <span class="ss">:password_confirmation</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Note that weve written</p>
<div class="code"><div class="highlight"><pre><span class="n">redirect_to</span> <span class="vi">@user</span>
</pre></div></div>
<p>where we could have used the equivalent</p>
<div class="code"><div class="highlight"><pre><span class="n">redirect_to</span> <span class="n">user_url</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span>
</pre></div></div>
<p>This is because Rails automatically infers from <code>redirect_to @user</code> that we want to redirect to <code>user_url(@user)</code>.</p>
<div id="_sec-exercises_the_finished_signup_form" data-tralics-id="uid918" class="subsubsection" data-number="7.4.1.1"><h4><a href="#sec-exercises_the_finished_signup_form" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Using the Rails console, verify that a user is in fact created when submitting valid information. <span class="exercise" id="ex-ae6165"></span>
</li>
<li>Confirm by updating <a href="https://www.railstutorial.org/book/sign_up#code-user_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.28</span></a> and submitting a valid user that <code>redirect_to user_url(@user)</code> has the same effect as <code>redirect_to @user</code>. <span class="exercise" id="ex-3f0fab"></span>
</li></ol>
</div></div>
<div id="_sec-the_flash" data-tralics-id="uid921" class="subsection" data-number="7.4.2"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-the_flash" class="heading hyperref"><span class="number">7.4.2 </span>The flash</a></h3>
<p>With the code in <a href="https://www.railstutorial.org/book/sign_up#code-user_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.28</span></a>,
 our signup form is actually working, but before submitting a valid 
registration in a browser were going to add a bit of polish common in 
web applications: a message that appears on the subsequent page (in this
 case, welcoming our new user to the application) and then disappears 
upon visiting a second page or on page reload.</p>
<p>The Rails way to display a temporary message is to use a special method called the <em>flash</em>, which we can treat like a hash.<span class="intersentencespace"></span> Rails adopts the convention of a <code>:success</code> key for a message indicating a successful result (<a href="https://www.railstutorial.org/book/sign_up#code-signup_flash" class="hyperref">Listing&nbsp;<span class="ref">7.29</span></a>).</p>
<div class="codelisting" id="_code-signup_flash" data-tralics-id="uid922" data-number="7.29"><div class="heading"><span class="number">Listing 7.29:</span> 

<span class="description">Adding a flash message to user signup.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/controllers/users_controller.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="k">class</span> <span class="nc">UsersController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="k">def</span> <span class="nf">create</span>
    <span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">user_params</span><span class="p">)</span>
    <span class="k">if</span> <span class="vi">@user</span><span class="o">.</span><span class="n">save</span>
<span class="hll">      <span class="n">flash</span><span class="o">[</span><span class="ss">:success</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"Welcome to the Sample App!"</span>
</span>      <span class="n">redirect_to</span> <span class="vi">@user</span>
    <span class="k">else</span>
      <span class="n">render</span> <span class="s1">'new'</span>
    <span class="k">end</span>
  <span class="k">end</span>

  <span class="kp">private</span>

    <span class="k">def</span> <span class="nf">user_params</span>
      <span class="n">params</span><span class="o">.</span><span class="n">require</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span><span class="o">.</span><span class="n">permit</span><span class="p">(</span><span class="ss">:name</span><span class="p">,</span> <span class="ss">:email</span><span class="p">,</span> <span class="ss">:password</span><span class="p">,</span>
                                   <span class="ss">:password_confirmation</span><span class="p">)</span>
    <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>By assigning a message to the <code>flash</code>, we are now in a position to display the message on the first page after the redirect.<span class="intersentencespace"></span> Our method is to iterate through the <code>flash</code> and insert all relevant messages into the site layout.<span class="intersentencespace"></span> You may recall the console example in <a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-hashes_and_symbols" class="hyperref">Section&nbsp;<span class="ref">4.3.3</span></a>, where we saw how to iterate through a hash using the strategically named <code>flash</code> variable (<a href="https://www.railstutorial.org/book/sign_up#code-flash_iteration" class="hyperref">Listing&nbsp;<span class="ref">7.30</span></a>).</p>
<div class="codelisting" id="_code-flash_iteration" data-tralics-id="uid923" data-number="7.30"><div class="heading"><span class="number">Listing 7.30:</span> 

<span class="description">Iterating through a <code>flash</code> hash in the console.</span>
</div>

<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="n">flash</span> <span class="o">=</span> <span class="p">{</span> <span class="ss">success</span><span class="p">:</span> <span class="s2">"It worked!"</span><span class="p">,</span> <span class="ss">danger</span><span class="p">:</span> <span class="s2">"It failed."</span> <span class="p">}</span>
<span class="go">=&gt; {:success=&gt;"It worked!", danger: "It failed."}</span>
<span class="gp">&gt;&gt; </span><span class="n">flash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="o">|</span>
<span class="gp">?&gt; </span>  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">key</span><span class="si">}</span><span class="s2">"</span>
<span class="gp">?&gt; </span>  <span class="nb">puts</span> <span class="s2">"</span><span class="si">#{</span><span class="n">value</span><span class="si">}</span><span class="s2">"</span>
<span class="gp">&gt;&gt; </span><span class="k">end</span>
<span class="go">success</span>
<span class="go">It worked!</span>
<span class="go">danger</span>
<span class="go">It failed.</span>
</pre></div></div></div><p>By following this pattern, we can arrange to display the contents of the flash site-wide using code like this:</p>
<div class="code"><div class="highlight"><pre><span class="cp">&lt;%</span> <span class="n">flash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message_type</span><span class="p">,</span> <span class="n">message</span><span class="o">|</span> <span class="cp">%&gt;</span>
  <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-</span><span class="cp">&lt;%=</span> <span class="n">message_type</span> <span class="cp">%&gt;</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">&lt;%=</span> <span class="n">message</span> <span class="cp">%&gt;</span><span class="nt">&lt;/div&gt;</span>
<span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>(This code is a particularly ugly and difficult-to-read combination of HTML and ERb; making it prettier is left as an exercise (<a href="https://www.railstutorial.org/book/sign_up#sec-exercises_a_test_for_valid_submission" class="hyperref">Section&nbsp;<span class="ref">7.4.4.1</span></a>).)<span class="intersentencespace"></span> Here the embedded Ruby</p>
<div class="code"><div class="highlight"><pre>alert-<span class="cp">&lt;%=</span> <span class="n">message_type</span> <span class="cp">%&gt;</span>
</pre></div></div>
<p>makes a CSS class corresponding to the type of message, so that for a <code>:success</code> message the class is</p>
<div class="code"><div class="highlight"><pre>alert-success
</pre></div></div>
<p>(The key <code>:success</code> is a symbol, but embedded Ruby automatically converts it to the string <code>"success"</code> before inserting it into the template.)<span class="intersentencespace"></span> Using a different class for each key allows us to apply different styles to different kinds of messages.<span class="intersentencespace"></span> For example, in <a href="https://www.railstutorial.org/book/basic_login#sec-rendering_with_a_flash_message" class="hyperref">Section&nbsp;<span class="ref">8.1.4</span></a> well use <code>flash[:danger]</code> to indicate a failed login attempt.<sup id="_cha-7_footnote-ref-11" class="footnote"><a href="#cha-7_footnote-11">11</a></sup><span class="intersentencespace"></span> (In fact, weve already used <code>alert-danger</code> once, to style the error message div in <a href="https://www.railstutorial.org/book/sign_up#code-errors_partial" class="hyperref">Listing&nbsp;<span class="ref">7.21</span></a>.)<span class="intersentencespace"></span> Bootstrap CSS supports styling for four such flash classes for increasingly urgent message types (<code>success</code>, <code>info</code>, <code>warning</code>, and <code>danger</code>), and well find occasion to use all of them in the course of developing the sample application (<code>info</code> in <a href="https://www.railstutorial.org/book/account_activation#sec-account_activation_emails" class="hyperref">Section&nbsp;<span class="ref">11.2</span></a>, <code>warning</code> in <a href="https://www.railstutorial.org/book/account_activation#sec-activating_the_account" class="hyperref">Section&nbsp;<span class="ref">11.3</span></a>, and <code>danger</code> for the first time in <a href="https://www.railstutorial.org/book/basic_login#sec-rendering_with_a_flash_message" class="hyperref">Section&nbsp;<span class="ref">8.1.4</span></a>).</p>
<p>Because the message is also inserted into the template, the full HTML result for</p>
<div class="code"><div class="highlight"><pre><span class="n">flash</span><span class="o">[</span><span class="ss">:success</span><span class="o">]</span> <span class="o">=</span> <span class="s2">"Welcome to the Sample App!"</span>
</pre></div></div>
<p>appears as follows:</p>
<div class="code"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-success"</span><span class="nt">&gt;</span>Welcome to the Sample App!<span class="nt">&lt;/div&gt;</span>
</pre></div></div>
<p>Putting the embedded Ruby discussed above into the site layout leads to the code in <a href="https://www.railstutorial.org/book/sign_up#code-layout_flash" class="hyperref">Listing&nbsp;<span class="ref">7.31</span></a>.</p>
<div class="codelisting" id="_code-layout_flash" data-tralics-id="uid925" data-number="7.31"><div class="heading"><span class="number">Listing 7.31:</span> 

<span class="description">Adding the contents of the <code>flash</code> variable to the site layout.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/layouts/application.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
  .
  .
  .
  <span class="nt">&lt;body&gt;</span>
    <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/header'</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"container"</span><span class="nt">&gt;</span>
<span class="hll">      <span class="cp">&lt;%</span> <span class="n">flash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message_type</span><span class="p">,</span> <span class="n">message</span><span class="o">|</span> <span class="cp">%&gt;</span>
</span><span class="hll">        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"alert alert-</span><span class="cp">&lt;%=</span> <span class="n">message_type</span> <span class="cp">%&gt;</span><span class="s">"</span><span class="nt">&gt;</span><span class="cp">&lt;%=</span> <span class="n">message</span> <span class="cp">%&gt;</span><span class="nt">&lt;/div&gt;</span>
</span><span class="hll">      <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
</span>      <span class="cp">&lt;%=</span> <span class="k">yield</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">render</span> <span class="s1">'layouts/footer'</span> <span class="cp">%&gt;</span>
      <span class="cp">&lt;%=</span> <span class="n">debug</span><span class="p">(</span><span class="n">params</span><span class="p">)</span> <span class="k">if</span> <span class="no">Rails</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">development?</span> <span class="cp">%&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    .
    .
    .
  <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div>
<div id="_sec-exercises_the_flash" data-tralics-id="uid926" class="subsubsection" data-number="7.4.2.1"><h4><a href="#sec-exercises_the_flash" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>In the console, confirm that you can use interpolation (<a href="https://www.railstutorial.org/book/rails_flavored_ruby#sec-strings" class="hyperref">Section&nbsp;<span class="ref">4.2.2</span></a>) to interpolate a raw symbol.<span class="intersentencespace"></span> For example, what is the return value of <code>"#{:success}"</code>? <span class="exercise" id="ex-46d5c1"></span>
</li>
<li>How does the previous exercise relate to the flash iteration shown in <a href="https://www.railstutorial.org/book/sign_up#code-flash_iteration" class="hyperref">Listing&nbsp;<span class="ref">7.30</span></a>? <span class="exercise" id="ex-77fcbe"></span>
</li></ol>
</div></div>
<div id="_sec-the_first_signup" data-tralics-id="uid929" class="subsection" data-number="7.4.3"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-the_first_signup" class="heading hyperref"><span class="number">7.4.3 </span>The first signup</a></h3>
<p>We can see the result of all this work by signing up the first user for the sample app.<span class="intersentencespace"></span> Even though previous submissions didnt work properly (as shown in <a href="https://www.railstutorial.org/book/sign_up#fig-valid_submission_error" class="hyperref">Figure&nbsp;<span class="ref">7.20</span></a>), the <code>user.save</code> line in the Users controller still works, so users might still have been created.<span class="intersentencespace"></span> To clear them out, well reset the database as follows:</p>
<div class="code"><div class="highlight"><pre>$ rails db:migrate:reset
</pre></div></div>
<p>On some systems you might have to restart the webserver (using Ctrl-C) for the changes to take effect (<a href="https://www.railstutorial.org/book/beginning#aside-technical_sophistication" class="hyperref">Box&nbsp;<span class="ref">1.1</span></a>).</p>
<p>Well create the first user with the name Rails Tutorial and email address example@railstutorial.org, as shown in <a href="https://www.railstutorial.org/book/sign_up#fig-first_signup" class="hyperref">Figure&nbsp;<span class="ref">7.22</span></a>).<span class="intersentencespace"></span> The resulting page (<a href="https://www.railstutorial.org/book/sign_up#fig-signup_flash" class="hyperref">Figure&nbsp;<span class="ref">7.23</span></a>) shows a friendly flash message upon successful signup, including nice green styling for the <code>success</code> class, which comes included with the Bootstrap CSS framework from <a href="https://www.railstutorial.org/book/filling_in_the_layout#sec-custom_css" class="hyperref">Section&nbsp;<span class="ref">5.1.2</span></a>.<span class="intersentencespace"></span> Then, upon reloading the user show page, the flash message disappears as promised (<a href="https://www.railstutorial.org/book/sign_up#fig-signup_flash_reloaded" class="hyperref">Figure&nbsp;<span class="ref">7.24</span></a>).</p>
<div class="center figure" id="_fig-first_signup" data-tralics-id="uid930" data-number="7.22">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/first_signup.png" alt="images/figures/first_signup"></div><div class="caption"><span class="header">Figure 7.22: </span><span class="description">Filling in the information for the first signup.
</span></div></div>
<div class="center figure" id="_fig-signup_flash" data-tralics-id="uid931" data-number="7.23">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_flash_3rd_edition.png" alt="images/figures/signup_flash_3rd_edition"></div><div class="caption"><span class="header">Figure 7.23: </span><span class="description">The results of a successful user signup, with flash message.
</span></div></div>
<div class="center figure" id="_fig-signup_flash_reloaded" data-tralics-id="uid932" data-number="7.24">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_flash_reloaded_3rd_edition.png" alt="images/figures/signup_flash_reloaded_3rd_edition"></div><div class="caption"><span class="header">Figure 7.24: </span><span class="description">The <code>flash</code>-less profile page after a browser reload.
</span></div></div>
<div id="_sec-exercises_the_first_signup" data-tralics-id="uid933" class="subsubsection" data-number="7.4.3.1"><h4><a href="#sec-exercises_the_first_signup" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Using the Rails console, find by the email address to double-check that the new user was actually created.<span class="intersentencespace"></span> The result should look something like <a href="https://www.railstutorial.org/book/sign_up#code-user_created" class="hyperref">Listing&nbsp;<span class="ref">7.32</span></a>. <span class="exercise" id="ex-478ab1"></span>
</li>
<li>Create a new user with your primary email address.<span class="intersentencespace"></span> Verify that the Gravatar correctly appears. <span class="exercise" id="ex-6d88e5"></span>
</li></ol>
<div class="codelisting" id="_code-user_created" data-tralics-id="uid936" data-number="7.32"><div class="heading"><span class="number">Listing 7.32:</span> 

<span class="description">Finding the newly created user in the database.</span>
</div>

<div class="code"><div class="highlight"><pre><span class="go">$ rails console</span>
<span class="gp">&gt;&gt; </span><span class="no">User</span><span class="o">.</span><span class="n">find_by</span><span class="p">(</span><span class="ss">email</span><span class="p">:</span> <span class="s2">"example@railstutorial.org"</span><span class="p">)</span>
<span class="go">=&gt; #&lt;User id: 1, name: "Rails Tutorial", email: "example@railstutorial.</span>
<span class="go">org", created_at: "2016-05-31 17:17:33", updated_at: "2016-05-31 17:17:33",</span>
<span class="go">password_digest: "$2a$10$8MaeHdnOhZvMk3GmFdmpPOeG6a7u7/k2Z9TMjOanC9G..."&gt;</span>
</pre></div></div></div></div></div>
<div id="_sec-a_test_for_valid_submission" data-tralics-id="uid937" class="subsection" data-number="7.4.4"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-a_test_for_valid_submission" class="heading hyperref"><span class="number">7.4.4 </span>A test for valid submission</a></h3>
<p>Before moving on, well write a test for valid submission to verify our applications behavior and catch regressions.<span class="intersentencespace"></span> As with the test for invalid submission in <a href="https://www.railstutorial.org/book/sign_up#sec-a_test_for_invalid_submission" class="hyperref">Section&nbsp;<span class="ref">7.3.4</span></a>, our main purpose is to verify the contents of the database.<span class="intersentencespace"></span> In this case, we want to submit valid information and then confirm that a user <em>was</em> created.<span class="intersentencespace"></span> In analogy with <a href="https://www.railstutorial.org/book/sign_up#code-a_test_for_invalid_submission" class="hyperref">Listing&nbsp;<span class="ref">7.23</span></a>, which used</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_no_difference</span> <span class="s1">'User.count'</span> <span class="k">do</span>
  <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
<span class="k">end</span>
</pre></div></div>
<p>here well use the corresponding <code>assert_difference</code> method:</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_difference</span> <span class="s1">'User.count'</span><span class="p">,</span> <span class="mi">1</span> <span class="k">do</span>
  <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="o">.</span><span class="n">.</span><span class="o">.</span>
<span class="k">end</span>
</pre></div></div>
<p>As with <code>assert_no_difference</code>, the first argument is the string <code>'User.count'</code>, which arranges for a comparison between <code>User.count</code> before and after the contents of the <code>assert_difference</code> block.<span class="intersentencespace"></span> The second (optional) argument specifies the size of the difference (in this case, 1).</p>
<p>Incorporating <code>assert_difference</code> into the file from <a href="https://www.railstutorial.org/book/sign_up#code-a_test_for_invalid_submission" class="hyperref">Listing&nbsp;<span class="ref">7.23</span></a> yields the test shown in <a href="https://www.railstutorial.org/book/sign_up#code-a_test_for_valid_submission" class="hyperref">Listing&nbsp;<span class="ref">7.33</span></a>.<span class="intersentencespace"></span> Note that weve used the <code>follow_redirect!</code> method after posting to the users path.<span class="intersentencespace"></span> This simply arranges to follow the redirect after submission, resulting in a rendering of the <code>'users/show'</code> template.<span class="intersentencespace"></span> (Its probably a good idea to write a test for the flash as well, which is left as an exercise (<a href="https://www.railstutorial.org/book/sign_up#sec-exercises_a_test_for_valid_submission" class="hyperref">Section&nbsp;<span class="ref">7.4.4.1</span></a>).)</p>
<div class="codelisting" id="_code-a_test_for_valid_submission" data-tralics-id="uid938" data-number="7.33"><div class="heading"><span class="number">Listing 7.33:</span> 

<span class="description">A test for a valid signup.<span class="intersentencespace"></span> <span style="color: ForestGreen"><span class="sc"></span><span class="sc"><strong>green</strong></span><span class="sc"></span></span><span class="break"></span> <code class="filepath">test/integration/users_signup_test.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>

<span class="k">class</span> <span class="nc">UsersSignupTest</span> <span class="o">&lt;</span> <span class="no">ActionDispatch</span><span class="o">::</span><span class="no">IntegrationTest</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="nb">test</span> <span class="s2">"valid signup information"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">signup_path</span>
    <span class="n">assert_difference</span> <span class="s1">'User.count'</span><span class="p">,</span> <span class="mi">1</span> <span class="k">do</span>
      <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="p">{</span> <span class="ss">user</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span>  <span class="s2">"Example User"</span><span class="p">,</span>
                                         <span class="ss">email</span><span class="p">:</span> <span class="s2">"user@example.com"</span><span class="p">,</span>
                                         <span class="ss">password</span><span class="p">:</span>              <span class="s2">"password"</span><span class="p">,</span>
                                         <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"password"</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">end</span>
    <span class="n">follow_redirect!</span>
    <span class="n">assert_template</span> <span class="s1">'users/show'</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><p>Note that <a href="https://www.railstutorial.org/book/sign_up#code-a_test_for_valid_submission" class="hyperref">Listing&nbsp;<span class="ref">7.33</span></a> also verifies that the user show template renders following successful signup.<span class="intersentencespace"></span> For this test to work, its necessary for the Users routes (<a href="https://www.railstutorial.org/book/sign_up#code-users_resource" class="hyperref">Listing&nbsp;<span class="ref">7.3</span></a>), the Users <code>show</code> action (<a href="https://www.railstutorial.org/book/sign_up#code-user_show_action" class="hyperref">Listing&nbsp;<span class="ref">7.5</span></a>), and the <code>show.html.erb</code> view (<a href="https://www.railstutorial.org/book/sign_up#code-user_show_view_with_gravatar" class="hyperref">Listing&nbsp;<span class="ref">7.8</span></a>) to work correctly.<span class="intersentencespace"></span> As a result, the one line</p>
<div class="code"><div class="highlight"><pre><span class="n">assert_template</span> <span class="s1">'users/show'</span>
</pre></div></div>
<p>is a sensitive test for almost everything related to a users profile page.<span class="intersentencespace"></span> This sort of end-to-end coverage of important application features illustrates one reason why integration tests are so useful.</p>
<div id="_sec-exercises_a_test_for_valid_submission" data-tralics-id="uid939" class="subsubsection" data-number="7.4.4.1"><h4><a href="#sec-exercises_a_test_for_valid_submission" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Write a test for the flash implemented in <a href="https://www.railstutorial.org/book/sign_up#sec-the_flash" class="hyperref">Section&nbsp;<span class="ref">7.4.2</span></a>.<span class="intersentencespace"></span> How detailed you want to make your tests is up to you; a suggested ultra-minimalist template appears in <a href="https://www.railstutorial.org/book/sign_up#code-flash_test" class="hyperref">Listing&nbsp;<span class="ref">7.34</span></a>, which you should complete by replacing <code>FILL_IN</code> with the appropriate code.<span class="intersentencespace"></span>
 (Even testing for the right key, much less the text, is likely to be 
brittle, so I prefer to test only that the flash isnt empty.) <span class="exercise" id="ex-714b39"></span>
</li>
<li>As noted above, the flash HTML in <a href="https://www.railstutorial.org/book/sign_up#code-layout_flash" class="hyperref">Listing&nbsp;<span class="ref">7.31</span></a> is ugly.<span class="intersentencespace"></span> Verify by running the test suite that the cleaner code in <a href="https://www.railstutorial.org/book/sign_up#code-layout_flash_content_tag" class="hyperref">Listing&nbsp;<span class="ref">7.35</span></a>, which uses the Rails <code>content_tag</code> helper, also works. <span class="exercise" id="ex-f0e99e"></span>
</li>
<li>Verify that the test fails if you comment out the redirect line in <a href="https://www.railstutorial.org/book/sign_up#code-user_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.28</span></a>. <span class="exercise" id="ex-d82d28"></span>
</li>
<li>Suppose we changed <code>@user.save</code> to <code>false</code> in <a href="https://www.railstutorial.org/book/sign_up#code-user_create_action" class="hyperref">Listing&nbsp;<span class="ref">7.28</span></a>.<span class="intersentencespace"></span> How does this change verify that the <code>assert_difference</code> block is testing the right thing? <span class="exercise" id="ex-98882d"></span>
</li></ol>
<div class="codelisting" id="_code-flash_test" data-tralics-id="uid944" data-number="7.34"><div class="heading"><span class="number">Listing 7.34:</span> 

<span class="description">A template for a test of the flash.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">test/integration/users_signup_test.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="nb">require</span> <span class="s1">'test_helper'</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="nb">test</span> <span class="s2">"valid signup information"</span> <span class="k">do</span>
    <span class="n">get</span> <span class="n">signup_path</span>
    <span class="n">assert_difference</span> <span class="s1">'User.count'</span><span class="p">,</span> <span class="mi">1</span> <span class="k">do</span>
      <span class="n">post</span> <span class="n">users_path</span><span class="p">,</span> <span class="ss">params</span><span class="p">:</span> <span class="p">{</span> <span class="ss">user</span><span class="p">:</span> <span class="p">{</span> <span class="nb">name</span><span class="p">:</span>  <span class="s2">"Example User"</span><span class="p">,</span>
                                         <span class="ss">email</span><span class="p">:</span> <span class="s2">"user@example.com"</span><span class="p">,</span>
                                         <span class="ss">password</span><span class="p">:</span>              <span class="s2">"password"</span><span class="p">,</span>
                                         <span class="ss">password_confirmation</span><span class="p">:</span> <span class="s2">"password"</span> <span class="p">}</span> <span class="p">}</span>
    <span class="k">end</span>
    <span class="n">follow_redirect!</span>
    <span class="n">assert_template</span> <span class="s1">'users/show'</span>
<span class="hll">    <span class="n">assert_not</span> <span class="n">flash</span><span class="o">.</span><span class="n">FILL_IN</span>
</span>  <span class="k">end</span>
<span class="k">end</span>
</pre></div></div></div><div class="codelisting" id="_code-layout_flash_content_tag" data-tralics-id="uid945" data-number="7.35"><div class="heading"><span class="number">Listing 7.35:</span> 

<span class="description">The <code>flash</code> ERb in the site layout using <code>content_tag</code>.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">app/views/layouts/application.html.erb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
      .
      .
      .
      <span class="cp">&lt;%</span> <span class="n">flash</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">message_type</span><span class="p">,</span> <span class="n">message</span><span class="o">|</span> <span class="cp">%&gt;</span>
<span class="hll">        <span class="cp">&lt;%=</span> <span class="n">content_tag</span><span class="p">(</span><span class="ss">:div</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">"alert alert-</span><span class="si">#{</span><span class="n">message_type</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span> <span class="cp">%&gt;</span>
</span>      <span class="cp">&lt;%</span> <span class="k">end</span> <span class="cp">%&gt;</span>
      .
      .
      .
<span class="nt">&lt;/html&gt;</span>
</pre></div></div></div></div></div></div><div id="_sec-professional_grade_deployment" data-tralics-id="cid42" class="section" data-number="7.5"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-professional_grade_deployment" class="heading hyperref"><span class="number">7.5 </span>Professional-grade deployment</a></h2>
<p>Now that we have a working signup page, its time to deploy our application and get it working in production.<span class="intersentencespace"></span> Although we started deploying our application in <a href="https://www.railstutorial.org/book/static_pages#cha-static_pages" class="hyperref">Chapter&nbsp;<span class="ref">3</span></a>, this is the first time it will actually <em>do</em> something, so well take this opportunity to make the deployment professional-grade.<span class="intersentencespace"></span>
 In particular, well add an important feature to the production 
application to make signup secure, well replace the default webserver 
with one suitable for real-world use, and well add some configuration 
for our production database.</p>
<p>As preparation for the deployment, you should merge your changes into the <code>master</code> branch at this point:</p>
<div class="code"><div class="highlight"><pre><span class="gp">$</span> git add -A
<span class="gp">$</span> git commit -m <span class="s2">"Finish user signup"</span>
<span class="gp">$</span> git checkout master
<span class="gp">$</span> git merge sign-up
</pre></div></div>
<div id="_sec-ssl_in_production" data-tralics-id="uid946" class="subsection" data-number="7.5.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-ssl_in_production" class="heading hyperref"><span class="number">7.5.1 </span>SSL in production</a></h3>
<p>When submitting the signup form developed in this chapter, the name, 
email address, and password get sent over the network, and hence are 
vulnerable to being intercepted by malicious users.<span class="intersentencespace"></span> This is a potentially serious security flaw in our application, and the way to fix it is to use <a href="https://en.wikipedia.org/wiki/Transport_Layer_Security" target="_blank" rel="noopener">Secure Sockets Layer (SSL)</a><sup id="_cha-7_footnote-ref-12" class="footnote"><a href="#cha-7_footnote-12">12</a></sup> to encrypt all relevant information before it leaves the local browser.<span class="intersentencespace"></span>
 Although we could use SSL on just the signup page, its actually easier
 to implement it site-wide, which has the additional benefits of 
securing user login (<a href="https://www.railstutorial.org/book/basic_login#cha-basic_login" class="hyperref">Chapter&nbsp;<span class="ref">8</span></a>) and making our application immune to the critical <em>session hijacking</em> vulnerability discussed in <a href="https://www.railstutorial.org/book/advanced_login#sec-remember_me" class="hyperref">Section&nbsp;<span class="ref">9.1</span></a>.</p>
<p>Although Heroku uses SSL by default, it doesnt <em>force</em> browsers to use it, so any users hitting our application using regular http will be interacting insecurely with the site.<span class="intersentencespace"></span> (You can see how this works by editing the URL in the address bar to changes https to http.)<span class="intersentencespace"></span> Luckily, forcing browsers to use SSL is as easy as uncommenting a single line in <code>production.rb</code>, the configuration file for production applications.<span class="intersentencespace"></span> As shown in <a href="https://www.railstutorial.org/book/sign_up#code-ssl_in_production" class="hyperref">Listing&nbsp;<span class="ref">7.36</span></a>, all we need to do is set <code>config.force_ssl</code> to <code>true</code>.</p>
<div class="codelisting" id="_code-ssl_in_production" data-tralics-id="uid948" data-number="7.36"><div class="heading"><span class="number">Listing 7.36:</span> 

<span class="description">Configuring the application to use SSL in production.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">config/environments/production.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
  <span class="c1"># Force all access to the app over SSL, use Strict-Transport-Security,</span>
  <span class="c1"># and use secure cookies.</span>
<span class="hll">  <span class="n">config</span><span class="o">.</span><span class="n">force_ssl</span> <span class="o">=</span> <span class="kp">true</span>
</span>  <span class="o">.</span>
  <span class="o">.</span>
  <span class="o">.</span>
<span class="k">end</span>
</pre></div></div></div><p>At this stage, we need to set up SSL on the remote server.<span class="intersentencespace"></span> Setting up a production site to use SSL involves purchasing and configuring an <em>SSL certificate</em> for your domain.<span class="intersentencespace"></span>
 Thats a lot of work, though, and luckily we wont need it here: for an
 application running on a Heroku domain (such as the sample 
application), we can piggyback on Herokus SSL certificate.<span class="intersentencespace"></span> As a result, when we deploy the application in <a href="https://www.railstutorial.org/book/sign_up#sec-production_webserver" class="hyperref">Section&nbsp;<span class="ref">7.5.2</span></a>, SSL will automatically be enabled.<span class="intersentencespace"></span> (If you want to run SSL on a custom domain, such as www.example.com, refer to <a href="http://devcenter.heroku.com/articles/ssl" target="_blank" rel="noopener">Herokus documentation on SSL</a>.)</p>
</div>
<div id="_sec-production_webserver" data-tralics-id="uid949" class="subsection" data-number="7.5.2"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-production_webserver" class="heading hyperref"><span class="number">7.5.2 </span>Production webserver</a></h3>
<p>Having added SSL, we now need to configure our application to use a webserver suitable for production applications.<span class="intersentencespace"></span>
 By default, Heroku uses a pure-Ruby webserver called WEBrick, which is 
easy to set up and run but isnt good at handling significant traffic.<span class="intersentencespace"></span> As a result, WEBrick <a href="https://devcenter.heroku.com/articles/ruby-default-web-server" target="_blank" rel="noopener">isnt suitable for production use</a>, so well <a href="https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="noopener">replace WEBrick with Puma</a>, an HTTP server that is capable of handling a large number of incoming requests.</p>
<p>To add the new webserver, we simply follow the <a href="https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="noopener">Heroku Puma documentation</a>.<span class="intersentencespace"></span> The first step is to include the <code class="tt">puma</code> gem in our <code>Gemfile</code>, but as of Rails&nbsp;5 Puma is included by default (<a href="https://www.railstutorial.org/book/static_pages#code-gemfile_sample_app" class="hyperref">Listing&nbsp;<span class="ref">3.2</span></a>).<span class="intersentencespace"></span> This means we can skip right to the second step, which is to replace the default contents of the file <code>config/puma.rb</code> with the configuration shown in <a href="https://www.railstutorial.org/book/sign_up#code-production_webserver_config" class="hyperref">Listing&nbsp;<span class="ref">7.37</span></a>.<span class="intersentencespace"></span> The code in <a href="https://www.railstutorial.org/book/sign_up#code-production_webserver_config" class="hyperref">Listing&nbsp;<span class="ref">7.37</span></a> comes straight from the <a href="https://devcenter.heroku.com/articles/deploying-rails-applications-with-the-puma-web-server" target="_blank" rel="noopener">Heroku documentation</a>,<sup id="_cha-7_footnote-ref-13" class="footnote"><a href="#cha-7_footnote-13">13</a></sup> and there is no need to understand it (<a href="https://www.railstutorial.org/book/beginning#aside-technical_sophistication" class="hyperref">Box&nbsp;<span class="ref">1.1</span></a>).</p>
<div class="codelisting" id="_code-production_webserver_config" data-tralics-id="uid951" data-number="7.37"><div class="heading"><span class="number">Listing 7.37:</span> 

<span class="description">The configuration file for the production webserver.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">config/puma.rb</code></span>
</div>

<div class="code"><div class="highlight"><pre><span class="n">workers</span> <span class="nb">Integer</span><span class="p">(</span><span class="no">ENV</span><span class="o">[</span><span class="s1">'WEB_CONCURRENCY'</span><span class="o">]</span> <span class="o">||</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">threads_count</span> <span class="o">=</span> <span class="nb">Integer</span><span class="p">(</span><span class="no">ENV</span><span class="o">[</span><span class="s1">'RAILS_MAX_THREADS'</span><span class="o">]</span> <span class="o">||</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">threads</span> <span class="n">threads_count</span><span class="p">,</span> <span class="n">threads_count</span>

<span class="n">preload_app!</span>

<span class="n">rackup</span>      <span class="no">DefaultRackup</span>
<span class="n">port</span>        <span class="no">ENV</span><span class="o">[</span><span class="s1">'PORT'</span><span class="o">]</span>     <span class="o">||</span> <span class="mi">3000</span>
<span class="n">environment</span> <span class="no">ENV</span><span class="o">[</span><span class="s1">'RACK_ENV'</span><span class="o">]</span> <span class="o">||</span> <span class="s1">'development'</span>

<span class="n">on_worker_boot</span> <span class="k">do</span>
  <span class="c1"># Worker specific setup for Rails 4.1+</span>
  <span class="c1"># See: https://devcenter.heroku.com/articles/</span>
  <span class="c1"># deploying-rails-applications-with-the-puma-web-server#on-worker-boot</span>
  <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span><span class="o">.</span><span class="n">establish_connection</span>
<span class="k">end</span>
</pre></div></div></div><p>We also need to make a so-called <code>Procfile</code> to tell Heroku to run a Puma process in production, as shown in <a href="https://www.railstutorial.org/book/sign_up#code-procfile" class="hyperref">Listing&nbsp;<span class="ref">7.38</span></a>.<span class="intersentencespace"></span> The <code>Procfile</code> should be created in your applications root directory (i.e., in the same location as the <code>Gemfile</code>).</p>
<div class="codelisting" id="_code-procfile" data-tralics-id="uid952" data-number="7.38"><div class="heading"><span class="number">Listing 7.38:</span> 

<span class="description">Defining a <code>Procfile</code> for Puma.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">./Procfile</code></span>
</div>

<div class="code"><div class="highlight"><pre>web: bundle <span class="nb">exec </span>puma -C config/puma.rb
</pre></div></div></div></div>
<div id="_sec-production_database_configuration" data-tralics-id="uid953" class="subsection" data-number="7.5.3"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-production_database_configuration" class="heading hyperref"><span class="number">7.5.3 </span>Production database configuration</a></h3>
<p>The final step in our production deployment is properly configuring the production database, which (as mentioned briefly in <a href="https://www.railstutorial.org/book/toy_app#sec-deploying_the_toy_app" class="hyperref">Section&nbsp;<span class="ref">2.3.5</span></a>) is <a href="https://www.postgresql.org/" target="_blank" rel="noopener">PostgreSQL</a>.<span class="intersentencespace"></span> My testing indicates that PostgreSQL actually works on Heroku without any configuration, but the <a href="https://devcenter.heroku.com/articles/getting-started-with-rails5" target="_blank" rel="noopener">official Heroku documentation</a> recommends explicit configuration nonetheless, so well err on the side of caution and include it.</p>
<p>The actual change is easy: all we have to do is update the <code>production</code> section of the database configuration file, <code>config/database.yml</code>.<span class="intersentencespace"></span> The result, which I adapted from the Heroku docs, is shown in <a href="https://www.railstutorial.org/book/sign_up#code-database_yml" class="hyperref">Listing&nbsp;<span class="ref">7.39</span></a>.</p>
<div class="codelisting" id="_code-database_yml" data-tralics-id="uid954" data-number="7.39"><div class="heading"><span class="number">Listing 7.39:</span> 

<span class="description">Configuring the database for production.<span class="intersentencespace"></span> <span class="break"></span> <code class="filepath">config/database.yml</code></span>
</div>

<div class="code"><div class="highlight"><pre><span></span><span class="c1"># SQLite version 3.x</span>
<span class="c1">#   gem install sqlite3</span>
<span class="c1">#</span>
<span class="c1">#   Ensure the SQLite 3 gem is defined in your Gemfile</span>
<span class="c1">#   gem 'sqlite3'</span>
<span class="c1">#</span>
<span class="l l-Scalar l-Scalar-Plain">default</span><span class="p p-Indicator">:</span> <span class="nl">&amp;default</span>
  <span class="l l-Scalar l-Scalar-Plain">adapter</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sqlite3</span>
  <span class="l l-Scalar l-Scalar-Plain">pool</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5</span>
  <span class="l l-Scalar l-Scalar-Plain">timeout</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">5000</span>

<span class="l l-Scalar l-Scalar-Plain">development</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;&lt;</span><span class="p p-Indicator">:</span> <span class="nv">*default</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/development.sqlite3</span>

<span class="c1"># Warning: The database defined as "test" will be erased and</span>
<span class="c1"># re-generated from your development database when you run "rake".</span>
<span class="c1"># Do not set this db to the same as development or production.</span>
<span class="l l-Scalar l-Scalar-Plain">test</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">&lt;&lt;</span><span class="p p-Indicator">:</span> <span class="nv">*default</span>
  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">db/test.sqlite3</span>

<span class="hll"><span class="l l-Scalar l-Scalar-Plain">production</span><span class="p p-Indicator">:</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">&lt;&lt;</span><span class="p p-Indicator">:</span> <span class="nv">*default</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">database</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sample_app_production</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">username</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">sample_app</span>
</span><span class="hll">  <span class="l l-Scalar l-Scalar-Plain">password</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">&lt;%= ENV['SAMPLE_APP_DATABASE_PASSWORD'] %&gt;</span>
</span></pre></div></div></div></div>
<div id="_sec-production_deployment" data-tralics-id="uid955" class="subsection" data-number="7.5.4"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-production_deployment" class="heading hyperref"><span class="number">7.5.4 </span>Production deployment</a></h3>
<p>With the production webserver and database configuration completed, were ready to commit and deploy:<sup id="_cha-7_footnote-ref-14" class="footnote"><a href="#cha-7_footnote-14">14</a></sup></p>
<div class="code"><div class="highlight"><pre>$ rails test
$ git add -A
$ git commit -m "Use SSL and the Puma webserver in production"
$ git push
$ git push heroku
$ heroku run rails db:migrate
</pre></div></div>
<p>The signup form is now live, and the result of a successful signup is shown in <a href="https://www.railstutorial.org/book/sign_up#fig-signup_in_production" class="hyperref">Figure&nbsp;<span class="ref">7.25</span></a>.<span class="intersentencespace"></span> Note the presence of <code class="tt">https://</code> and a lock icon in the address bar of <a href="https://www.railstutorial.org/book/sign_up#fig-signup_in_production" class="hyperref">Figure&nbsp;<span class="ref">7.25</span></a>, which indicate that SSL is working.</p>
<div class="center figure" id="_fig-signup_in_production" data-tralics-id="uid957" data-number="7.25">
<div class="graphics image"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/signup_in_production_4th_edition.png" alt="images/figures/signup_in_production_4th_edition"></div><div class="caption"><span class="header">Figure 7.25: </span><span class="description">Signing up on the live Web.
</span></div></div>
<div id="_sec-ruby_version_number" data-tralics-id="uid958" class="subsubsection" data-number="7.5.4.1"><h4><a href="#sec-ruby_version_number" class="heading">Ruby version number</a></h4>
<p>When deploying to Heroku, you may get a warning message like this one:</p>
<div class="code"><div class="highlight"><pre>###### WARNING:
       You have not declared a Ruby version in your Gemfile.
       To set your Ruby version add this line to your Gemfile:
       ruby '2.1.5'
</pre></div></div>
<p>Experience shows that, at the level of this tutorial, the costs 
associated with including such an explicit Ruby version number outweigh 
the (negligible) benefits, so you should ignore this warning for now.<span class="intersentencespace"></span> The main issue is that keeping your sample app and system in sync with the latest Ruby version can be a huge inconvenience,<sup id="_cha-7_footnote-ref-15" class="footnote"><a href="#cha-7_footnote-15">15</a></sup> and yet it almost never makes a difference which exact Ruby version number you use.<span class="intersentencespace"></span>
 Nevertheless, you should bear in mind that, should you ever end up 
running a mission-critical app on Heroku, specifying an exact Ruby 
version in the <code>Gemfile</code> is recommended to ensure maximum compatibility between development and production environments.</p>
</div>
<div id="_sec-exercises_puma_in_production" data-tralics-id="uid960" class="subsubsection" data-number="7.5.4.2"><h4><a href="#sec-exercises_puma_in_production" class="heading">Exercises</a></h4>
<p> </p><div class="society-note">
<p>Solutions to exercises are available for free with any Rails Tutorial <a href="https://www.railstutorial.org/" target="_blank" rel="noopener">purchase</a>.<span class="intersentencespace"></span> To see other peoples answers and to record your own, join the <a href="http://learnenough.com/society" target="_blank" rel="noopener">Learn Enough Society</a> at <a href="http://learnenough.com/society" target="_blank" rel="noopener">learnenough.com/society</a>.<span class="intersentencespace"></span>  </p></div>
<ol>
<li>Confirm on your browser that the SSL lock and <code>https</code> appear. <span class="exercise" id="ex-00415c"></span>
</li>
<li>Create a user on the production site using your primary email address.<span class="intersentencespace"></span> Does your Gravatar appear correctly? <span class="exercise" id="ex-cbc029"></span>
</li></ol>
</div></div></div><div id="_sec-sign_up_conclusion" data-tralics-id="cid43" class="section" data-number="7.6"><h2><a href="https://www.railstutorial.org/book/sign_up#sec-sign_up_conclusion" class="heading hyperref"><span class="number">7.6 </span>Conclusion</a></h2>
<p>Being able to sign up users is a major milestone for our application.<span class="intersentencespace"></span> Although the sample app has yet to accomplish anything useful, we have laid an essential foundation for all future development.<span class="intersentencespace"></span> In <a href="https://www.railstutorial.org/book/basic_login#cha-basic_login" class="hyperref">Chapter&nbsp;<span class="ref">8</span></a> and <a href="https://www.railstutorial.org/book/advanced_login#cha-advanced_login" class="hyperref">Chapter&nbsp;<span class="ref">9</span></a>,
 we will complete our authentication machinery by allowing users to log 
in and out of the application (with optional remember me 
functionality).<span class="intersentencespace"></span> In <a href="https://www.railstutorial.org/book/updating_and_deleting_users#cha-updating_showing_and_deleting_users" class="hyperref">Chapter&nbsp;<span class="ref">10</span></a>,
 we will allow all users to update their account information, and we 
will allow site administrators to delete users, thereby completing the 
full suite of Users resource REST actions from <a href="https://www.railstutorial.org/book/sign_up#table-RESTful_users" class="hyperref">Table&nbsp;<span class="ref">7.1</span></a>.</p>
<div id="_sec-sign_up_what_we_learned_in_this_chapter" data-tralics-id="uid963" class="subsection" data-number="7.6.1"><h3><a href="https://www.railstutorial.org/book/sign_up#sec-sign_up_what_we_learned_in_this_chapter" class="heading hyperref"><span class="number">7.6.1 </span>What we learned in this chapter</a></h3>
<ul>
<li>Rails displays useful debug information via the <code>debug</code> method.
</li>
<li>Sass mixins allow a group of CSS rules to be bundled and reused in multiple places.
</li>
<li>Rails comes with three standard environments: <code>development</code>, <code>test</code>, and <code>production</code>.
</li>
<li>We can interact with users as a <em>resource</em> through a standard set of REST URLs.
</li>
<li>Gravatars provide a convenient way of displaying images to represent users.
</li>
<li>The <code>form_for</code> helper is used to generate forms for interacting with Active Record objects.
</li>
<li>Signup failure renders the new user page and displays error messages automatically determined by Active Record.
</li>
<li>Rails provides the <code>flash</code> as a standard way to display temporary messages.
</li>
<li>Signup success creates a user in the database and redirects to the user show page, and displays a welcome message.
</li>
<li>We can use integration tests to verify form submission behavior and catch regressions.
</li>
<li>We can configure our production application to use SSL for secure communications and Puma for high performance.
</li></ul>
</div></div><div id="cha-7_footnotes">
  <div class="footnotes">
    <div id="_cha-7_footnote-1" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-1">1.</a> <a href="http://gomockingbird.com/" target="_blank" rel="noopener">Mockingbird</a> doesnt support custom images like the profile photo in <a href="https://www.railstutorial.org/book/sign_up#fig-profile_mockup_profile_name" class="hyperref">Figure&nbsp;<span class="ref">7.1</span></a>; I put that in by hand using <a href="http://www.gimp.org/" target="_blank" rel="noopener">GIMP</a>.</div>
    <div id="_cha-7_footnote-2" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-2">2.</a> Image retrieved from http://www.flickr.com/photos/43803060@N00/24308857/ on 2014-06-16.<span class="intersentencespace"></span> Copyright  2002 by Shaun Wallin and used unaltered under the terms of the <a href="https://creativecommons.org/licenses/by/2.0/" target="_blank" rel="noopener">Creative Commons Attribution 2.0 Generic</a> license.</div>
    <div id="_cha-7_footnote-3" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-3">3.</a> You can define your own custom environments as well; see the <a href="http://railscasts.com/episodes/72-adding-an-environment" target="_blank" rel="noopener">RailsCast on adding an environment</a> for details.</div>
    <div id="_cha-7_footnote-4" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-4">4.</a> The exact appearance of the Rails debug information is slightly version-dependent.<span class="intersentencespace"></span> For example, as of Rails&nbsp;5 the debug information shows the <code>permitted</code> status of the information, a subject well cover in <a href="https://www.railstutorial.org/book/sign_up#sec-strong_parameters" class="hyperref">Section&nbsp;<span class="ref">7.3.2</span></a>.<span class="intersentencespace"></span> Use your technical sophistication (<a href="https://www.railstutorial.org/book/beginning#aside-technical_sophistication" class="hyperref">Box&nbsp;<span class="ref">1.1</span></a>) to resolve such minor discrepancies.</div>
    <div id="_cha-7_footnote-5" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-5">5.</a> The Rails <code>debug</code> information is shown as <a href="http://www.yaml.org/" target="_blank" rel="noopener">YAML</a> (a <a href="http://catb.org/jargon/html/R/recursive-acronym.html" target="_blank" rel="noopener">recursive acronym</a> standing for YAML Aint Markup Language), which is a friendly data format designed to be both machine- <em>and</em> human-readable.</div>
    <div id="_cha-7_footnote-6" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-6">6.</a> This means that the <em>routing</em> works, but the corresponding pages dont necessarily work at this point.<span class="intersentencespace"></span> For example, /users/1/edit gets routed properly to the <code>edit</code> action of the Users controller, but since the <code>edit</code> action doesnt exist yet actually hitting that URL will return an error.</div>
    <div id="_cha-7_footnote-7" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-7">7.</a> Using, e.g., <code>touch app/views/users/show.html.erb</code>.</div>
    <div id="_cha-7_footnote-8" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-8">8.</a> In Hinduism, an avatar is the manifestation of a deity in human or animal form.<span class="intersentencespace"></span> By extension, the term <em>avatar</em> is commonly used to mean some kind of personal representation, especially in a virtual environment.<span class="intersentencespace"></span> (In the context of Twitter and other social media, the term <em>avi</em> has gained currency, which is likely a mutated form of <em>avatar</em>.)</div>
    <div id="_cha-7_footnote-9" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-9">9.</a> <a href="https://www.railstutorial.org/book/sign_up#code-sidebar_css" class="hyperref">Listing&nbsp;<span class="ref">7.11</span></a> includes the <code>.gravatar_edit</code> class, which well put to work in <a href="https://www.railstutorial.org/book/updating_and_deleting_users#cha-updating_showing_and_deleting_users" class="hyperref">Chapter&nbsp;<span class="ref">10</span></a>.</div>
    <div id="_cha-7_footnote-10" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-10">10.</a> See the <a href="http://stackoverflow.com/questions/941594/understand-rails-authenticity-token" target="_blank" rel="noopener">Stack Overflow entry on the Rails authenticity token</a> if youre interested in the details of how this works.</div>
    <div id="_cha-7_footnote-11" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-11">11.</a> Actually, well use the closely related <code>flash.now</code>, but well defer that subtlety until we need it.</div>
    <div id="_cha-7_footnote-12" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-12">12.</a> Technically, SSL is now TLS, for Transport Layer Security, but everyone I know still says SSL.</div>
    <div id="_cha-7_footnote-13" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-13">13.</a> <a href="https://www.railstutorial.org/book/sign_up#code-production_webserver_config" class="hyperref">Listing&nbsp;<span class="ref">7.37</span></a> changes the formatting slightly so that the code fits in the standard 80 columns.</div>
    <div id="_cha-7_footnote-14" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-14">14.</a>
 We havent changed the data model in this chapter, so running the 
migration at Heroku shouldnt be necessary, but only if you followed the
 steps in <a href="https://www.railstutorial.org/book/modeling_users#sec-modeling_users_conclusion" class="hyperref">Section&nbsp;<span class="ref">6.4</span></a>.<span class="intersentencespace"></span> Because several readers reported having trouble, Ive added <code>heroku run rails db:migrate</code> as a final step just to be safe.</div>
    <div id="_cha-7_footnote-15" class="footnote"><a class="footnote-link" href="#cha-7_footnote-ref-15">15.</a>
 For example, at one point Heroku required Ruby 2.1.4, so I spent 
several hours trying unsuccessfully to install Ruby 2.1.4 on my local 
machineonly to discover that Ruby 2.1.5 had been released the previous 
day.<span class="intersentencespace"></span> Attempts to install Ruby 2.1.5 then also failed.</div>
  </div>
</div></div></div>
</div>
<div class="book-bottom-menu">
<div class="bookMenu-arrows">
<a class="leftArrow" href="javascript://"></a>
<a class="upArrow" href="javascript://"></a>
<a class="rightArrow" href="javascript://"></a>
</div>
</div>
</div>
<div id="bookContentNotAvailable">
<img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/empty_content-bfd29214ec2dceaedc8664ee5d1379fb01c94658fb95ac.png" alt="Empty content">
Sorry, content not available
</div>
</div>
<div class="emailPitch" id="bookEmailModal">
<a onclick="closeEmailPops()" class="emailSignupClose" href="javascript://">x</a>

<div class="j_followBookForm"><div id="j_bookFollowForm">
<form action="https://www.softcover.io/books/216/follow" accept-charset="UTF-8" data-remote="true" method="get"><input name="utf8" type="hidden" value="">
<!-- %input{name: "name", type: "text", placeholder: "YOUR NAME"} -->
<input name="email" placeholder="Your email address" type="text">
<input class="greyButton optClick_follow" data-disable-with="Submitting..." type="submit" value="Follow Author">
</form>

<p id="j_bookFollowNotice" style="display:none"></p>
</div>
</div>
</div>
<script>
  // setup book nav
  $(function(){
    Book.init({
      title: "Ruby on Rails Tutorial (Rails 5)",
      path: "/book",
      slug: "ruby_on_rails_tutorial_4th_edition",
      isArticle: false,
      s3_path_prefix: "636/ruby_on_rails_tutorial_4th_edition",
      chapters: [{"title":"Frontmatter","number":0,"slug":"frontmatter","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/frontmatter_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=b53482a71da3253a11087b74446c3709321b00230f21fa827548c555988b2618"},{"title":"Chapter 1: From zero to deploy","number":1,"slug":"beginning","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/beginning_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=9ee9d88269a2acdd2cbd6210aab4272557b2c8f392e6d2cab6fe621b1deaf951"},{"title":"Chapter 2: A toy app","number":2,"slug":"toy_app","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/toy_app_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ec2b008bd777fb8a8cfc40a3af54e597cfe92bdc70654a967b2a1590a249a9c4"},{"title":"Chapter 3: Mostly static pages","number":3,"slug":"static_pages","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/static_pages_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e82a39d0194a8993981c43ea93cf088061cfeb2e4f018d45a06a4e6d6b049e20"},{"title":"Chapter 4: Rails-flavored Ruby","number":4,"slug":"rails_flavored_ruby","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/rails_flavored_ruby_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=462f24803893d039666e488ce6392b0bcd21586ad66489cefa89731038b3dd19"},{"title":"Chapter 5: Filling in the layout","number":5,"slug":"filling_in_the_layout","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/filling_in_the_layout_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=841ad2c9d394354b8c0249677a39d2f31fd1d2c43239fb4eaec5c1ce4af2ede9"},{"title":"Chapter 6: Modeling users","number":6,"slug":"modeling_users","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/modeling_users_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042335Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=382ad6e5d455a31a2c620bced2dc657313626b10de98966e05aa326f95246210"},{"title":"Chapter 7: Sign up","number":7,"slug":"sign_up","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/sign_up_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=ba548892d05366623b90f271d4588378123571226c1c043e6532af7e5d178825"},{"title":"Chapter 8: Basic login","number":8,"slug":"basic_login","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/basic_login_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=68bbd7948ccbdc69537dcd0e38e41ea9481d5fc9a93867c2afe9cf69290b0bd6"},{"title":"Chapter 9: Advanced login","number":9,"slug":"advanced_login","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/advanced_login_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e72861fafaca0c31667417c8f809921c20df68409494274aa71840ec1c0c6c6c"},{"title":"Chapter 10: Updating, showing, and deleting users","number":10,"slug":"updating_and_deleting_users","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/updating_and_deleting_users_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=87e3f855390cd1aba1ac1cc38da33c49171828393b56e1a958dace2489aa6790"},{"title":"Chapter 11: Account activation","number":11,"slug":"account_activation","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/account_activation_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=e63c8b2b7d2c4919d3a3928060350acee3ff827a25b5d1c7e20ccf2797186548"},{"title":"Chapter 12: Password reset","number":12,"slug":"password_reset","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/password_reset_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=25b5995e24943ee0bcf84276e3f2a56c1c4c30ee5afb8d9ce6b85381d8356274"},{"title":"Chapter 13: User microposts","number":13,"slug":"user_microposts","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/user_microposts_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=110bb86f202e5faee74e9bc3fc5a4b08d3fc3980fc86a166edabb3d54be58095"},{"title":"Chapter 14: Following users","number":14,"slug":"following_users","s3_url":"https://softcover.s3-us-west-2.amazonaws.com/636/ruby_on_rails_tutorial_4th_edition/html/following_users_fragment.html?X-Amz-Expires=604800\u0026X-Amz-Date=20190710T042336Z\u0026X-Amz-Algorithm=AWS4-HMAC-SHA256\u0026X-Amz-Credential=AKIAJMNNDDBSYVXVHGAA/20190710/us-west-2/s3/aws4_request\u0026X-Amz-SignedHeaders=host\u0026X-Amz-Signature=78b838f14b130f64ff502e0a65bfd8913a5d4368e3134162248b3e7958cf8c89"}],
      full_page: false,
      custom_math: "\"failing\": \"\\\\coloredtext{red}{\\\\textsc{\\\\textbf{red}}}\",\n\"passing\": \"\\\\coloredtext{ForestGreen}{\\\\textsc{\\\\textbf{green}}}\",\n\"rt\": \"\\\\emph{Rails Tutorial}\",\n\"letbd\": \"\\\\href{https://www.learnenough.com/story}{Learn Enough to Be Dangerous}\",\n\"lesite\": \"\\\\href{https://www.learnenough.com/}{Learn Enough}\",\n\"lecl\": \"\\\\href{https://www.learnenough.com/command-line}{\\\\emph{Learn Enough Command Line to Be Dangerous}}\",\n\"leg\": \"\\\\href{https://www.learnenough.com/git}{\\\\emph{Learn Enough Git to Be Dangerous}}\",\n\"leh\": \"\\\\href{https://www.learnenough.com/html}{\\\\emph{Learn Enough HTML to Be Dangerous}}\",\n\"ler\": \"\\\\href{https://www.learnenough.com/ruby}{\\\\emph{Learn Enough Ruby to Be Dangerous}}\",\n\"lete\": \"\\\\href{https://www.learnenough.com/text-editor}{\\\\emph{Learn Enough Text Editor to Be Dangerous}}\",\n\"rort\": \"\\\\href{https://www.railstutorial.org/}{Ruby on Rails Tutorial}\",\n\"rortb\": \"\\\\href{https://www.railstutorial.org/book}{\\\\emph{Ruby on Rails Tutorial}}\",\n\"lev\": \"\\\\href{https://www.learnenough.com/vim}{\\\\emph{Learn Enough Vim to Be Dangerous}}\",\n\"les\": \"\\\\href{https://www.learnenough.com/sinatra}{\\\\emph{Learn Enough Sinatra to Be Dangerous}}\",\n\"lera\": \"\\\\href{https://www.learnenough.com/ruby-on-rails}{\\\\emph{Learn Enough Rails to Be Dangerous}}\",\n\"lecss\": \"\\\\href{https://www.learnenough.com/css-and-layout}{\\\\emph{Learn Enough CSS \\\\& Layout to Be Dangerous}}\",\n\"ledev\": \"\\\\href{https://www.learnenough.com/dev-environment}{\\\\emph{Learn Enough Dev Environment to Be Dangerous}}\",\n\"ccby\": \"\\\\href{https://creativecommons.org/licenses/by/2.0/}{Creative Commons Attribution 2.0 Generic}\",\n\"ccbysa\": \"\\\\href{https://creativecommons.org/licenses/by-sa/2.0/}{Creative Commons Attribution-ShareAlike 2.0 Generic}\",\n\"ccbync\": \"\\\\href{https://creativecommons.org/licenses/by-nc/2.0/}{Creative Commons Attribution-NonCommercial 2.0 Generic}\",\n\"ccbynd\": \"\\\\href{https://creativecommons.org/licenses/by-nd/2.0/}{Creative Commons Attribution-NoDerivs 2.0 Generic}\",\n\"xkcduse\": \"Copyright  Randall Munroe and used unaltered under the terms of the \\\\href{https://creativecommons.org/licenses/by-nc/2.5/}{Creative Commons Attribution-NonCommercial 2.5 Generic} license.\",\n\"gemfilenote\": \"\\\\textbf{Important note: For all the Gemfiles in this book, you should use the version numbers listed at \\\\href{https://gemfiles-4th-ed.railstutorial.org/}{gemfiles-4th-ed.rails\\\\-tutorial.org} instead of the ones listed below (although they should be identical if you are reading this online).}\",\n\"secondgemfilenote\": \"As always, you should use the version numbers listed at \\\\href{https://gemfiles-4th-ed.railstutorial.org/}{gemfiles-4th-ed.rails\\\\-tutorial.org} instead of the ones listed here.\""
    });
    Book.scrolling();
  });
</script>

<div class="footer clearfix">
<div class="wrapper" id="hide_chromeFooter">
<em>powered by</em>
<a class="logo" href="http://www.softcover.io/"><img src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/logo_foot-2bb1fc62a4fe7cfdd8223560afd5fea72ad2696d7a3886cfe4.png" alt="Logo foot">
</a></div>
</div>

</div>
</div>
<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.perfectaudience.com/serve/54eea5d20a23b37d87000040.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);
  })();
</script>

<script type="text/javascript">
setTimeout(function(){var a=document.createElement("script");
var b=document.getElementsByTagName("script")[0];
a.src=document.location.protocol+"//dnn506yrbagrg.cloudfront.net/pages/scripts/0023/6713.js?"+Math.floor(new Date().getTime()/3600000);
a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
</script>



<iframe allowtransparency="true" scrolling="no" name="__privateStripeMetricsController0" allowpaymentrequest="true" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/outer.html" aria-hidden="true" tabindex="-1" style="border: medium none !important; margin: 0px !important; padding: 0px !important; width: 1px !important; min-width: 100% !important; overflow: hidden !important; display: block !important; visibility: hidden !important; position: fixed !important; height: 1px !important; pointer-events: none !important;" frameborder="0"></iframe><iframe scrolling="no" allowtransparency="true" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/widget_iframe.html" title="Twitter settings iframe" style="display: none;" frameborder="0"></iframe><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div><iframe name="fb_xdm_frame_https" id="fb_xdm_frame_https" aria-hidden="true" title="Facebook Cross Domain Communication Frame" tabindex="-1" allowtransparency="true" allowfullscreen="true" scrolling="no" allow="encrypted-media" style="border: medium none;" src="Chapter%207%20%20Sign%20up%20|%20Ruby%20on%20Rails%20Tutorial%20(Rails%205)%20|%20Softcover.io_files/xd_arbiter.html" frameborder="0"></iframe></div><div></div></div></div></body></html>